(()=>{"use strict";class e{constructor(){this.projects=[],this.activeProject,console.log(this.projects)}addProject(e){return this.projects.push(e),this.projects}removeProject(e){}}class t{constructor(e){this.name=e,this.todos=[],this.id}addToDo(e){this.todos.push(e)}removeToDo(e){const t=this.todos.findIndex((t=>t.id===e));this.todos.splice(t,1),console.log(this.todos)}setId(e){this.id=e}findToDoByID(e){const t=this.todos.findIndex((t=>t.id===e));return this.todos[t]}}class o{constructor(e,t,o,s){this.title=e,this.description=t,this.date=o,this.priority=s,this.isFinished=!1,this.id,this.parentId}markAsFinished(){this.isFinished=!1===this.isFinished}setId(e){this.id=e}setParentId(e){this.parentId=e}}new class{constructor(){}};const s=new class{constructor(){}renderToDo=e=>{const t=document.querySelector("ul"),o=document.createElement("li"),s=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div"),i=document.createElement("div"),l=document.createElement("div"),c=document.createElement("div"),d=document.createElement("div");d.classList.add("title-element"),s.classList.add("todo"),d.textContent=e.title,s.classList.add(`${e.priority}`),i.textContent="delete",i.classList.add("delete"),l.classList.add("finish"),l.textContent="mark",c.classList.add("show-full"),c.textContent="+",r.classList.add("btns-container"),r.appendChild(c),r.appendChild(l),r.appendChild(i),s.appendChild(d),s.appendChild(r),o.appendChild(s),n.classList.add("todo-full"),n.classList.add("hidden"),n.insertAdjacentHTML("afterbegin",`\n    \n    <p>\n      Description: ${e.description}\n    </p>\n    <p>Date: ${e.date}</p>`),o.appendChild(n),o.setAttribute("data-id",`${e.id}`),t.appendChild(o)};renderForm(){if(document.querySelector(".new-form-container"))return;const e=document.querySelector(".container"),t=document.createElement("div");t.classList.add("new-form-container");const o=document.createElement("form");o.setAttribute("action","submit"),o.insertAdjacentHTML("afterbegin",'<div class="field">\n<label for="title">Title: </label>\n<input type="text" name="title" id="title" required/>\n</div>\n<div class="field">\n<label for="description">Description: </label>\n<input type="text" name="description" id="description" required/>\n</div>\n<div class="field">\n<label for="date">Date: </label>\n<input type="date" name="date" id="date" required/>\n</div>\n<div class="radio-btn">\n<label for="low-prio">Low</label>\n<input type="radio" name="priority" id="low-prio" value="low" />\n<label for="med-prio">Medium</label>\n<input type="radio" name="priority" id="med-prio" value="med" />\n<label for="high-prio">High</label>\n<input type="radio" name="priority" id="high-prio" value="high" checked/>\n</div>\n<button type="submit">Submit</button>\n<div class="close-form"><div class="x">X</div></div>\n'),t.appendChild(o),e.insertAdjacentElement("afterbegin",t),document.querySelector(".close-form").addEventListener("click",(function(){t.remove()}))}renderProjectPreview(e){const t=document.createElement("div");t.classList.add("project");const o=document.createElement("div");o.classList.add("project-preview"),console.log(e.name,e),o.textContent=`${e.name}`,t.setAttribute("data-id",`${e.id}`),t.appendChild(o),document.querySelector(".project-container").appendChild(t)}renderToDoPreview(e){console.log("render start");const t=document.createElement("div");t.classList.add("todo-preview"),t.textContent=`${e.title}`,document.querySelector(`.project[data-id='${e.parentId}']`).insertAdjacentElement("beforeend",t)}renderAllToDo(e){this.clearToDoList(),e.forEach((e=>this.renderToDo(e)))}clearToDoList(){document.querySelector(".todos-list ul").innerHTML=""}todoShow(e){console.log(e),e.classList.toggle("hidden")}renderAllProjectPreview(e){e.projects.forEach((e=>this.renderProjectPreview(e)))}rednerAllToDoPreview(e){console.log(e.projects);for(let t=0;t<e.projects.length;t++)e.projects[t].todos.forEach((e=>this.renderToDoPreview(e)))}clearToDoPreview(){document.querySelectorAll(".todo-preview").forEach((e=>e.remove()))}toggleFinishedMark(e){e.querySelector(".title-element").classList.toggle("finished"),e.querySelector(".todo-full").classList.toggle("finished")}};console.log("START");let n=new e;const r=new t("Project Default"),i=new o("Gogogo","odin","today","low");i.parentId=1,i.setId(1),r.addToDo(i),r.setId(1),n.addProject(r),n.activeProject=n.projects[0];let l=new class{constructor(e){this.base=e,this.projects=e.projects,this.todos=this.projects.map((e=>e.todos)),this.baseResult}getToDos(e){this.todos=this.projects.map((e=>e.todos));const t=JSON.parse(e),s=JSON.parse(e);for(let e=0;e<t.length;e++)t[e]=t[e].map((e=>new o(e.title,e.description,e.date,e.priority)));for(let e=0;e<t.length;e++)t[e]=t[e].map(((t,o)=>Object.assign(t,s[e][o])));return t}getProjects(e){let o=JSON.parse(e);return console.log("--------------0-0-0-0-0-0-0-0"),console.log(o),o.map((e=>new t(e.name))).map(((e,t)=>Object.assign(e,o[t])))}getBase(t){const o=JSON.parse(t);let s=new e;return s=Object.assign(s,o),s}saveData(e){const t=JSON.stringify(e),o=JSON.stringify(e.projects),s=JSON.stringify(e.projects.map((e=>e.todos)));localStorage.setItem("base",t),localStorage.setItem("projects",o),localStorage.setItem("todos",s),console.log(t),console.log(o),console.log(s);const n=this.getBase(t),r=this.getProjects(o),i=this.getToDos(s);console.log(i),console.log(r),console.log(n);for(let e=0;e<r.length;e++)r[e].todos=i[e];return console.log("--------------------------------"),n.projects=r,n.activeProject=n.projects[0],console.log(n),n}loadData(){const e=this.getBase(localStorage.getItem("base")),t=this.getProjects(localStorage.getItem("projects")),o=this.getToDos(localStorage.getItem("todos"));console.log(o),console.log(t),console.log(e);for(let e=0;e<t.length;e++)t[e].todos=o[e];return console.log("--------------------------------"),e.projects=t,e.activeProject=e.projects[0],console.log(e),e}}(n),c=n.activeProject;n=localStorage.getItem("base")?l.loadData():n,c=n.activeProject,console.log(n),s.renderAllProjectPreview(n),s.rednerAllToDoPreview(n),console.log(c),s.renderAllToDo(c.todos);const d=document.querySelector(".new-todo-btn"),a=document.querySelector(".project-form"),p=document.querySelector("aside");d.addEventListener("click",(function(){s.renderForm(),document.querySelector("form").addEventListener("submit",u),localStorage.setItem("wtf","WHAT THE FUCK")}));const u=function(e){e.preventDefault();const{title:t,description:r,date:i,priority:d}=Object.fromEntries(new FormData(this)),a=new o(t,r,i,d);a.setId(c.todos.length+1),a.setParentId(c.id),c.addToDo(a),s.renderToDo(...c.todos.slice(-1)),console.log(c.todos.slice(-1)),l.saveData(n),s.renderToDoPreview(a)};document.querySelector("ul").addEventListener("click",(e=>{const t=e.target.closest(".delete");if(!t)return;const o=t.closest("li");c.removeToDo(+o.dataset.id),o.remove(),s.clearToDoPreview(),s.rednerAllToDoPreview(n),l.saveData(n)})),a.addEventListener("submit",(function(e){e.preventDefault();const o=this.querySelector("input").value;console.log(o),console.log("clickclack");const r=new t(o);r.setId(n.projects.length+1),n.addProject(r),this.querySelector("input").value="",console.log(n.projects),console.log(n),s.renderProjectPreview(r)})),p.addEventListener("click",(function(e){const t=e.target.closest(".project-preview");t&&t.textContent!==c.name&&(console.log("project selected"),console.log(t),c=n.projects.find((e=>e.name===t.textContent)),n.activeProject=c,console.log(c),s.renderAllToDo(c.todos),console.log(c.todos),console.log(n))})),document.querySelector("ul").addEventListener("click",(function(e){const t=e.target.closest(".show-full");t&&(console.log(t),t.textContent="+"===t.textContent?"-":"+",s.todoShow(t.closest(".todo").nextSibling))})),document.querySelector("ul").addEventListener("click",(function(e){const t=e.target.closest(".finish");if(!t)return;const o=t.closest("li");console.log(o.dataset.id),console.log(c.findToDoByID(+o.dataset.id)),c.findToDoByID(+o.dataset.id).markAsFinished(),s.toggleFinishedMark(o),l.saveData(n)})),console.log(localStorage.getItem("wtf"))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cEQsaUJBQWlCLFNBQVMsU0FBVXNELEdBQ3hDLE1BQU1hLEVBQXNCYixFQUFNTSxPQUFPQyxRQUFRLG9CQUM1Q00sR0FDREEsRUFBb0I1RSxjQUFnQjNDLEVBQWNRLE9BQ3REUCxRQUFRQyxJQUFJLG9CQUNaRCxRQUFRQyxJQUFJcUgsR0FFWnZILEVBQWdCa0UsRUFBS25FLFNBQVN5SCxNQUMzQnBILEdBQVlBLEVBQVFJLE9BQVMrRyxFQUFvQjVFLGNBRXBEdUIsRUFBS2xFLGNBQWdCQSxFQUdyQkMsUUFBUUMsSUFBSUYsR0FDWixnQkFBa0JBLEVBQWNTLE9BRWhDUixRQUFRQyxJQUFJRixFQUFjUyxPQUMxQlIsUUFBUUMsSUFBSWdFLE9BR2RuQyxTQUFTQyxjQUFjLE1BQU1vQixpQkFBaUIsU0FBUyxTQUFVc0QsR0FDL0QsTUFBTWUsRUFBY2YsRUFBTU0sT0FBT0MsUUFBUSxjQUNwQ1EsSUFDTHhILFFBQVFDLElBQUl1SCxHQUNaQSxFQUFZOUUsWUFBMEMsTUFBNUI4RSxFQUFZOUUsWUFBc0IsSUFBTSxJQUNsRSxXQUFhOEUsRUFBWVIsUUFBUSxTQUFTUyxpQkFHNUMzRixTQUFTQyxjQUFjLE1BQU1vQixpQkFBaUIsU0FBUyxTQUFVc0QsR0FDL0QsTUFBTWlCLEVBQW9CakIsRUFBTU0sT0FBT0MsUUFBUSxXQUMvQyxJQUFLVSxFQUFtQixPQUN4QixNQUFNL0csRUFBTytHLEVBQWtCVixRQUFRLE1BQ3ZDaEgsUUFBUUMsSUFBSVUsRUFBS3VHLFFBQVF6RyxJQUN6QlQsUUFBUUMsSUFBSUYsRUFBY2tCLGNBQWNOLEVBQUt1RyxRQUFRekcsS0FDckRWLEVBQWNrQixjQUFjTixFQUFLdUcsUUFBUXpHLElBQUlpQixpQkFDN0MscUJBQXVCZixHQUN2QmdFLEVBQU9rQixTQUFTNUIsTUE4QmxCakUsUUFBUUMsSUFBSThGLGFBQWFLLFFBQVEsUyIsInNvdXJjZXMiOlsid2VicGFjazovL29kaW4tdG9kby8uL3NyYy9EYXRhLmpzIiwid2VicGFjazovL29kaW4tdG9kby8uL3NyYy9Qcm9qZWN0LmpzIiwid2VicGFjazovL29kaW4tdG9kby8uL3NyYy9Ub0RvLmpzIiwid2VicGFjazovL29kaW4tdG9kby8uL3NyYy9IYW5kbGVyLmpzIiwid2VicGFjazovL29kaW4tdG9kby8uL3NyYy9ET00uanMiLCJ3ZWJwYWNrOi8vb2Rpbi10b2RvLy4vc3JjL01hcmtkb3duLmpzIiwid2VicGFjazovL29kaW4tdG9kby8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG8vLi9zcmMvTG9jYWxTdG9yYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIERhdGEge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnByb2plY3RzID0gW107XG4gICAgdGhpcy5hY3RpdmVQcm9qZWN0O1xuICAgIGNvbnNvbGUubG9nKHRoaXMucHJvamVjdHMpO1xuICB9XG5cbiAgYWRkUHJvamVjdChwcm9qZWN0KSB7XG4gICAgdGhpcy5wcm9qZWN0cy5wdXNoKHByb2plY3QpO1xuICAgIHJldHVybiB0aGlzLnByb2plY3RzO1xuICB9XG4gIHJlbW92ZVByb2plY3QocHJvamVjdCkge31cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFByb2plY3Qge1xuICBjb25zdHJ1Y3RvcihuYW1lKSB7XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICB0aGlzLnRvZG9zID0gW107XG4gICAgdGhpcy5pZDtcbiAgfVxuXG4gIGFkZFRvRG8odG9kbykge1xuICAgIC8vIHRvZG8uc2V0SWQodGhpcy50b2Rvcy5sZW5ndGggKyAxKTtcbiAgICB0aGlzLnRvZG9zLnB1c2godG9kbyk7XG4gIH1cbiAgcmVtb3ZlVG9EbyhpZCkge1xuICAgIGNvbnN0IHRvZG8gPSB0aGlzLnRvZG9zLmZpbmRJbmRleCgoZWxlbWVudCkgPT4gZWxlbWVudC5pZCA9PT0gaWQpO1xuICAgIHRoaXMudG9kb3Muc3BsaWNlKHRvZG8sIDEpO1xuICAgIGNvbnNvbGUubG9nKHRoaXMudG9kb3MpO1xuICB9XG4gIHNldElkKGlkKSB7XG4gICAgdGhpcy5pZCA9IGlkO1xuICB9XG4gIGZpbmRUb0RvQnlJRChpZCkge1xuICAgIGNvbnN0IHRvZG9JZCA9IHRoaXMudG9kb3MuZmluZEluZGV4KChlbGVtZW50KSA9PiBlbGVtZW50LmlkID09PSBpZCk7XG4gICAgcmV0dXJuIHRoaXMudG9kb3NbdG9kb0lkXTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVG9EbyB7XG4gIGNvbnN0cnVjdG9yKHRpdGxlLCBkZXNjcmlwdGlvbiwgZGF0ZSwgcHJpb3JpdHkpIHtcbiAgICB0aGlzLnRpdGxlID0gdGl0bGU7XG4gICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgIHRoaXMuZGF0ZSA9IGRhdGU7XG4gICAgdGhpcy5wcmlvcml0eSA9IHByaW9yaXR5O1xuICAgIHRoaXMuaXNGaW5pc2hlZCA9IGZhbHNlO1xuICAgIHRoaXMuaWQ7XG4gICAgdGhpcy5wYXJlbnRJZDtcbiAgfVxuXG4gIG1hcmtBc0ZpbmlzaGVkKCkge1xuICAgIHRoaXMuaXNGaW5pc2hlZCA9IHRoaXMuaXNGaW5pc2hlZCA9PT0gZmFsc2UgPyB0cnVlIDogZmFsc2U7XG4gIH1cblxuICBzZXRJZChpZCkge1xuICAgIHRoaXMuaWQgPSBpZDtcbiAgfVxuICBzZXRQYXJlbnRJZChwYXJlbnRJZCkge1xuICAgIHRoaXMucGFyZW50SWQgPSBwYXJlbnRJZDtcbiAgfVxufVxuIiwiY2xhc3MgSGFuZGxlciB7XG4gIGNvbnN0cnVjdG9yKCkge31cbn1cblxuZXhwb3J0IGRlZmF1bHQgbmV3IEhhbmRsZXIoKTtcbiIsImltcG9ydCBIYW5kbGVyIGZyb20gJy4vSGFuZGxlcic7XG5pbXBvcnQgeyBmb3JtTWFya2Rvd24gfSBmcm9tICcuL01hcmtkb3duJztcblxuY2xhc3MgRE9NIHtcbiAgY29uc3RydWN0b3IoKSB7fVxuXG4gIHJlbmRlclRvRG8gPSAodG9kbykgPT4ge1xuICAgIGNvbnN0IHVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigndWwnKTtcbiAgICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgY29uc3QgdG9kb0VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29uc3QgdG9kb0Z1bGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjb25zdCBidG5zQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29uc3QgZGVsZXRlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29uc3QgZmluaXNoZWRCdXRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNvbnN0IHNob3dGdWxsQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0aXRsZS5jbGFzc0xpc3QuYWRkKCd0aXRsZS1lbGVtZW50Jyk7XG4gICAgdG9kb0VsLmNsYXNzTGlzdC5hZGQoJ3RvZG8nKTtcbiAgICB0aXRsZS50ZXh0Q29udGVudCA9IHRvZG8udGl0bGU7XG4gICAgdG9kb0VsLmNsYXNzTGlzdC5hZGQoYCR7dG9kby5wcmlvcml0eX1gKTtcbiAgICBkZWxldGVCdG4udGV4dENvbnRlbnQgPSAnZGVsZXRlJztcbiAgICBkZWxldGVCdG4uY2xhc3NMaXN0LmFkZCgnZGVsZXRlJyk7XG4gICAgZmluaXNoZWRCdXRvbi5jbGFzc0xpc3QuYWRkKCdmaW5pc2gnKTtcbiAgICBmaW5pc2hlZEJ1dG9uLnRleHRDb250ZW50ID0gJ21hcmsnO1xuICAgIHNob3dGdWxsQnRuLmNsYXNzTGlzdC5hZGQoJ3Nob3ctZnVsbCcpO1xuICAgIHNob3dGdWxsQnRuLnRleHRDb250ZW50ID0gJysnO1xuICAgIGJ0bnNDb250YWluZXIuY2xhc3NMaXN0LmFkZCgnYnRucy1jb250YWluZXInKTtcbiAgICBidG5zQ29udGFpbmVyLmFwcGVuZENoaWxkKHNob3dGdWxsQnRuKTtcbiAgICBidG5zQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpbmlzaGVkQnV0b24pO1xuICAgIGJ0bnNDb250YWluZXIuYXBwZW5kQ2hpbGQoZGVsZXRlQnRuKTtcbiAgICB0b2RvRWwuYXBwZW5kQ2hpbGQodGl0bGUpO1xuICAgIHRvZG9FbC5hcHBlbmRDaGlsZChidG5zQ29udGFpbmVyKTtcbiAgICBsaS5hcHBlbmRDaGlsZCh0b2RvRWwpO1xuXG4gICAgdG9kb0Z1bGwuY2xhc3NMaXN0LmFkZCgndG9kby1mdWxsJyk7XG4gICAgdG9kb0Z1bGwuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gICAgdG9kb0Z1bGwuaW5zZXJ0QWRqYWNlbnRIVE1MKFxuICAgICAgJ2FmdGVyYmVnaW4nLFxuICAgICAgYFxuICAgIFxuICAgIDxwPlxuICAgICAgRGVzY3JpcHRpb246ICR7dG9kby5kZXNjcmlwdGlvbn1cbiAgICA8L3A+XG4gICAgPHA+RGF0ZTogJHt0b2RvLmRhdGV9PC9wPmBcbiAgICApO1xuICAgIGxpLmFwcGVuZENoaWxkKHRvZG9GdWxsKTtcbiAgICBsaS5zZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnLCBgJHt0b2RvLmlkfWApO1xuICAgIHVsLmFwcGVuZENoaWxkKGxpKTtcbiAgfTtcblxuICByZW5kZXJGb3JtKCkge1xuICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmV3LWZvcm0tY29udGFpbmVyJykpIHJldHVybjtcblxuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWluZXInKTtcbiAgICBjb25zdCBmb3JtQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgZm9ybUNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCduZXctZm9ybS1jb250YWluZXInKTtcblxuICAgIGNvbnN0IGZvcm1FbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2Zvcm0nKTtcbiAgICBmb3JtRWwuc2V0QXR0cmlidXRlKCdhY3Rpb24nLCAnc3VibWl0Jyk7XG4gICAgZm9ybUVsLmluc2VydEFkamFjZW50SFRNTCgnYWZ0ZXJiZWdpbicsIGZvcm1NYXJrZG93bik7XG4gICAgZm9ybUNvbnRhaW5lci5hcHBlbmRDaGlsZChmb3JtRWwpO1xuICAgIGNvbnRhaW5lci5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyYmVnaW4nLCBmb3JtQ29udGFpbmVyKTtcblxuICAgIGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcignLmNsb3NlLWZvcm0nKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBmb3JtQ29udGFpbmVyLnJlbW92ZSgpO1xuICAgICAgfSk7XG4gIH1cblxuICByZW5kZXJQcm9qZWN0UHJldmlldyhwcm9qZWN0KSB7XG4gICAgY29uc3QgcHJvamVjdEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgcHJvamVjdEVsLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QnKTtcbiAgICBjb25zdCBwcm9qZWN0UHJldmlldyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHByb2plY3RQcmV2aWV3LmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QtcHJldmlldycpO1xuICAgIGNvbnNvbGUubG9nKHByb2plY3QubmFtZSwgcHJvamVjdCk7XG4gICAgcHJvamVjdFByZXZpZXcudGV4dENvbnRlbnQgPSBgJHtwcm9qZWN0Lm5hbWV9YDtcbiAgICBwcm9qZWN0RWwuc2V0QXR0cmlidXRlKCdkYXRhLWlkJywgYCR7cHJvamVjdC5pZH1gKTtcblxuICAgIHByb2plY3RFbC5hcHBlbmRDaGlsZChwcm9qZWN0UHJldmlldyk7XG5cbiAgICBjb25zdCBwYXJlbnRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3QtY29udGFpbmVyJyk7XG4gICAgcGFyZW50RWxlbWVudC5hcHBlbmRDaGlsZChwcm9qZWN0RWwpO1xuICB9XG5cbiAgcmVuZGVyVG9Eb1ByZXZpZXcodG9kbykge1xuICAgIGNvbnNvbGUubG9nKCdyZW5kZXIgc3RhcnQnKTtcbiAgICBjb25zdCB0b2RvUHJldmlld0VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdG9kb1ByZXZpZXdFbC5jbGFzc0xpc3QuYWRkKCd0b2RvLXByZXZpZXcnKTtcbiAgICB0b2RvUHJldmlld0VsLnRleHRDb250ZW50ID0gYCR7dG9kby50aXRsZX1gO1xuICAgIGNvbnN0IHByb2plY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYC5wcm9qZWN0W2RhdGEtaWQ9JyR7dG9kby5wYXJlbnRJZH0nXWBcbiAgICApO1xuXG4gICAgcHJvamVjdC5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2JlZm9yZWVuZCcsIHRvZG9QcmV2aWV3RWwpO1xuICB9XG5cbiAgcmVuZGVyQWxsVG9Ebyh0b2Rvcykge1xuICAgIHRoaXMuY2xlYXJUb0RvTGlzdCgpO1xuICAgIHRvZG9zLmZvckVhY2goKHRvZG8pID0+IHRoaXMucmVuZGVyVG9Ebyh0b2RvKSk7XG4gIH1cblxuICBjbGVhclRvRG9MaXN0KCkge1xuICAgIGNvbnN0IHRvRG9MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRvZG9zLWxpc3QgdWwnKTtcbiAgICB0b0RvTGlzdC5pbm5lckhUTUwgPSAnJztcbiAgfVxuXG4gIHRvZG9TaG93KHRvZG8pIHtcbiAgICBjb25zb2xlLmxvZyh0b2RvKTtcbiAgICB0b2RvLmNsYXNzTGlzdC50b2dnbGUoJ2hpZGRlbicpO1xuICB9XG5cbiAgcmVuZGVyQWxsUHJvamVjdFByZXZpZXcoYmFzZSkge1xuICAgIGJhc2UucHJvamVjdHMuZm9yRWFjaCgocHJvamVjdCkgPT4gdGhpcy5yZW5kZXJQcm9qZWN0UHJldmlldyhwcm9qZWN0KSk7XG4gIH1cblxuICByZWRuZXJBbGxUb0RvUHJldmlldyhiYXNlKSB7XG4gICAgY29uc29sZS5sb2coYmFzZS5wcm9qZWN0cyk7XG4gICAgLy8gaWYgKCFiYXNlLnByb2plY3RzLnRvZG9zKSByZXR1cm47XG4gICAgLy8gYmFzZS5wcm9qZWN0cy5mb3JFYWNoKChwcm9qZWN0KSA9PlxuICAgIC8vICAgcHJvamVjdC50b2Rvcy5mb3JFYWNoKCh0b2RvKSA9PiB0aGlzLnJlbmRlclRvRG9QcmV2aWV3KHRvZG8pKVxuICAgIC8vICk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiYXNlLnByb2plY3RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBiYXNlLnByb2plY3RzW2ldLnRvZG9zLmZvckVhY2goKHRvZG8pID0+IHRoaXMucmVuZGVyVG9Eb1ByZXZpZXcodG9kbykpO1xuICAgIH1cbiAgfVxuXG4gIGNsZWFyVG9Eb1ByZXZpZXcoKSB7XG4gICAgY29uc3QgdG9Eb1ByZXZpZXdzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRvZG8tcHJldmlldycpO1xuICAgIHRvRG9QcmV2aWV3cy5mb3JFYWNoKChwcmV2aWV3KSA9PiBwcmV2aWV3LnJlbW92ZSgpKTtcbiAgfVxuXG4gIHRvZ2dsZUZpbmlzaGVkTWFyayh0b2RvKSB7XG4gICAgdG9kby5xdWVyeVNlbGVjdG9yKCcudGl0bGUtZWxlbWVudCcpLmNsYXNzTGlzdC50b2dnbGUoJ2ZpbmlzaGVkJyk7XG4gICAgdG9kby5xdWVyeVNlbGVjdG9yKCcudG9kby1mdWxsJykuY2xhc3NMaXN0LnRvZ2dsZSgnZmluaXNoZWQnKTtcbiAgICAvLyB0b2RvLnF1ZXJ5U2VsZWN0b3IoJy5idG5zLWNvbnRhaW5lcicpLmNsYXNzTGlzdC5hZGQoJ25vcGUnKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBuZXcgRE9NKCk7XG4iLCJjb25zdCBmb3JtTWFya2Rvd24gPSBgPGRpdiBjbGFzcz1cImZpZWxkXCI+XG48bGFiZWwgZm9yPVwidGl0bGVcIj5UaXRsZTogPC9sYWJlbD5cbjxpbnB1dCB0eXBlPVwidGV4dFwiIG5hbWU9XCJ0aXRsZVwiIGlkPVwidGl0bGVcIiByZXF1aXJlZC8+XG48L2Rpdj5cbjxkaXYgY2xhc3M9XCJmaWVsZFwiPlxuPGxhYmVsIGZvcj1cImRlc2NyaXB0aW9uXCI+RGVzY3JpcHRpb246IDwvbGFiZWw+XG48aW5wdXQgdHlwZT1cInRleHRcIiBuYW1lPVwiZGVzY3JpcHRpb25cIiBpZD1cImRlc2NyaXB0aW9uXCIgcmVxdWlyZWQvPlxuPC9kaXY+XG48ZGl2IGNsYXNzPVwiZmllbGRcIj5cbjxsYWJlbCBmb3I9XCJkYXRlXCI+RGF0ZTogPC9sYWJlbD5cbjxpbnB1dCB0eXBlPVwiZGF0ZVwiIG5hbWU9XCJkYXRlXCIgaWQ9XCJkYXRlXCIgcmVxdWlyZWQvPlxuPC9kaXY+XG48ZGl2IGNsYXNzPVwicmFkaW8tYnRuXCI+XG48bGFiZWwgZm9yPVwibG93LXByaW9cIj5Mb3c8L2xhYmVsPlxuPGlucHV0IHR5cGU9XCJyYWRpb1wiIG5hbWU9XCJwcmlvcml0eVwiIGlkPVwibG93LXByaW9cIiB2YWx1ZT1cImxvd1wiIC8+XG48bGFiZWwgZm9yPVwibWVkLXByaW9cIj5NZWRpdW08L2xhYmVsPlxuPGlucHV0IHR5cGU9XCJyYWRpb1wiIG5hbWU9XCJwcmlvcml0eVwiIGlkPVwibWVkLXByaW9cIiB2YWx1ZT1cIm1lZFwiIC8+XG48bGFiZWwgZm9yPVwiaGlnaC1wcmlvXCI+SGlnaDwvbGFiZWw+XG48aW5wdXQgdHlwZT1cInJhZGlvXCIgbmFtZT1cInByaW9yaXR5XCIgaWQ9XCJoaWdoLXByaW9cIiB2YWx1ZT1cImhpZ2hcIiBjaGVja2VkLz5cbjwvZGl2PlxuPGJ1dHRvbiB0eXBlPVwic3VibWl0XCI+U3VibWl0PC9idXR0b24+XG48ZGl2IGNsYXNzPVwiY2xvc2UtZm9ybVwiPjxkaXYgY2xhc3M9XCJ4XCI+WDwvZGl2PjwvZGl2PlxuYDtcblxuZXhwb3J0IHsgZm9ybU1hcmtkb3duIH07XG4iLCJpbXBvcnQgRGF0YSBmcm9tICcuL0RhdGEuanMnO1xuaW1wb3J0IFByb2plY3QgZnJvbSAnLi9Qcm9qZWN0LmpzJztcbmltcG9ydCBUb0RvIGZyb20gJy4vVG9Eby5qcyc7XG5pbXBvcnQgRE9NIGZyb20gJy4vRE9NLmpzJztcbmltcG9ydCBPYmplY3RIZWxwZXIgZnJvbSAnLi9Mb2NhbFN0b3JhZ2UuanMnO1xuXG4vLyBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnd3RmJywgJ1dURj8hPyE/IT8nKTtcblxuY29uc29sZS5sb2coJ1NUQVJUJyk7XG5sZXQgYmFzZSA9IG5ldyBEYXRhKCk7XG5cbmNvbnN0IHByb2plY3QxID0gbmV3IFByb2plY3QoJ1Byb2plY3QgRGVmYXVsdCcpO1xuXG5jb25zdCB0b2RvMSA9IG5ldyBUb0RvKCdHb2dvZ28nLCAnb2RpbicsICd0b2RheScsICdsb3cnKTtcbnRvZG8xLnBhcmVudElkID0gMTtcbnRvZG8xLnNldElkKDEpO1xuLy8gY29uc3QgdG9kbzIgPSBuZXcgVG9EbygnMicsICdkdmEnLCAndG9kYXknLCAnbG93Jyk7XG4vLyB0b2RvMi5wYXJlbnRJZCA9IDE7XG4vLyB0b2RvMi5zZXRJZCgyKTtcbnByb2plY3QxLmFkZFRvRG8odG9kbzEpO1xuLy8gcHJvamVjdDEuYWRkVG9Ebyh0b2RvMik7XG5wcm9qZWN0MS5zZXRJZCgxKTtcblxuLy8gY29uc3QgcHJvamVjdDIgPSBuZXcgUHJvamVjdCgnUHJvamVjdCAyJyk7XG4vLyBjb25zdCB0b2RvMyA9IG5ldyBUb0RvKCczJywgJ3RyaScsICd0b2RheScsICdoaWdoJyk7XG4vLyB0b2RvMy5wYXJlbnRJZCA9IDI7XG4vLyBwcm9qZWN0Mi5hZGRUb0RvKHRvZG8zKTtcbi8vIHByb2plY3QyLnNldElkKDIpO1xuXG5iYXNlLmFkZFByb2plY3QocHJvamVjdDEpO1xuXG4vLyBiYXNlLmFkZFByb2plY3QocHJvamVjdDIpO1xuXG4vLyBiYXNlID0gaGVscGVyLnNhdmVEYXRhKCk7XG5iYXNlLmFjdGl2ZVByb2plY3QgPSBiYXNlLnByb2plY3RzWzBdO1xubGV0IGhlbHBlciA9IG5ldyBPYmplY3RIZWxwZXIoYmFzZSk7XG5sZXQgYWN0aXZlUHJvamVjdCA9IGJhc2UuYWN0aXZlUHJvamVjdDtcbi8vIGhlbHBlci5zYXZlRGF0YSgpO1xuYmFzZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdiYXNlJykgPyBoZWxwZXIubG9hZERhdGEoKSA6IGJhc2U7XG4vLyBjb25zb2xlLmxvZyhoZWxwZXIubG9hZERhdGEoKSk7XG5cbmFjdGl2ZVByb2plY3QgPSBiYXNlLmFjdGl2ZVByb2plY3Q7XG5cbmNvbnNvbGUubG9nKGJhc2UpO1xuRE9NLnJlbmRlckFsbFByb2plY3RQcmV2aWV3KGJhc2UpO1xuRE9NLnJlZG5lckFsbFRvRG9QcmV2aWV3KGJhc2UpO1xuLy8gRE9NLnJlbmRlclByb2plY3RQcmV2aWV3KHByb2plY3QxKTtcbmNvbnNvbGUubG9nKGFjdGl2ZVByb2plY3QpO1xuRE9NLnJlbmRlckFsbFRvRG8oYWN0aXZlUHJvamVjdC50b2Rvcyk7XG5cbi8vIGNvbnNvbGUubG9nKGJhc2UucHJvamVjdHMuZmluZCgocHJvamVjdCkgPT4gcHJvamVjdC5uYW1lID09PSAncHJvamVjdDEnKSk7XG5cbi8vIGNvbnNvbGUuZGlyKGJhc2UpO1xuXG4vLyB0b2RvMS5pc0ZpbmlzaGVkID0gdHJ1ZTtcbi8vIGNvbnNvbGUuZGlyKGJhc2UpO1xuXG5jb25zdCBidG5OZXcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmV3LXRvZG8tYnRuJyk7XG5jb25zdCBmb3JtTmV3UHJvamVjdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0LWZvcm0nKTtcbmNvbnN0IGFzaWRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYXNpZGUnKTtcblxuYnRuTmV3LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICBET00ucmVuZGVyRm9ybSgpO1xuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdmb3JtJykuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgaGFuZGxlclN1Ym1pdCk7XG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd3dGYnLCAnV0hBVCBUSEUgRlVDSycpO1xufSk7XG5cbmNvbnN0IGhhbmRsZXJTdWJtaXQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3QgeyB0aXRsZSwgZGVzY3JpcHRpb24sIGRhdGUsIHByaW9yaXR5IH0gPSBPYmplY3QuZnJvbUVudHJpZXMoXG4gICAgbmV3IEZvcm1EYXRhKHRoaXMpXG4gICk7XG4gIGNvbnN0IHRvZG8gPSBuZXcgVG9Ebyh0aXRsZSwgZGVzY3JpcHRpb24sIGRhdGUsIHByaW9yaXR5KTtcbiAgdG9kby5zZXRJZChhY3RpdmVQcm9qZWN0LnRvZG9zLmxlbmd0aCArIDEpO1xuICB0b2RvLnNldFBhcmVudElkKGFjdGl2ZVByb2plY3QuaWQpO1xuICBhY3RpdmVQcm9qZWN0LmFkZFRvRG8odG9kbyk7XG4gIERPTS5yZW5kZXJUb0RvKC4uLmFjdGl2ZVByb2plY3QudG9kb3Muc2xpY2UoLTEpKTtcbiAgY29uc29sZS5sb2coYWN0aXZlUHJvamVjdC50b2Rvcy5zbGljZSgtMSkpO1xuICAvLyBoZWxwZXIgPSBuZXcgT2JqZWN0SGVscGVyKGJhc2UpO1xuICBoZWxwZXIuc2F2ZURhdGEoYmFzZSk7XG4gIERPTS5yZW5kZXJUb0RvUHJldmlldyh0b2RvKTtcbn07XG5cbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZlbnQpID0+IHtcbiAgY29uc3QgYnRuQ2xvc2UgPSBldmVudC50YXJnZXQuY2xvc2VzdCgnLmRlbGV0ZScpO1xuICBpZiAoIWJ0bkNsb3NlKSByZXR1cm47XG4gIGNvbnN0IHNlbGVjdGVkVG9EbyA9IGJ0bkNsb3NlLmNsb3Nlc3QoJ2xpJyk7XG4gIGFjdGl2ZVByb2plY3QucmVtb3ZlVG9Ebygrc2VsZWN0ZWRUb0RvLmRhdGFzZXQuaWQpO1xuICBzZWxlY3RlZFRvRG8ucmVtb3ZlKCk7XG4gIERPTS5jbGVhclRvRG9QcmV2aWV3KCk7XG4gIERPTS5yZWRuZXJBbGxUb0RvUHJldmlldyhiYXNlKTtcbiAgaGVscGVyLnNhdmVEYXRhKGJhc2UpO1xufSk7XG5cbmZvcm1OZXdQcm9qZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGZ1bmN0aW9uIChldmVudCkge1xuICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBwcm9qZWN0TmFtZSA9IHRoaXMucXVlcnlTZWxlY3RvcignaW5wdXQnKS52YWx1ZTtcbiAgY29uc29sZS5sb2cocHJvamVjdE5hbWUpO1xuICBjb25zb2xlLmxvZygnY2xpY2tjbGFjaycpO1xuICBjb25zdCBuZXdQcm9qZWN0ID0gbmV3IFByb2plY3QocHJvamVjdE5hbWUpO1xuICBuZXdQcm9qZWN0LnNldElkKGJhc2UucHJvamVjdHMubGVuZ3RoICsgMSk7XG4gIGJhc2UuYWRkUHJvamVjdChuZXdQcm9qZWN0KTtcbiAgdGhpcy5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpLnZhbHVlID0gJyc7XG5cbiAgY29uc29sZS5sb2coYmFzZS5wcm9qZWN0cyk7XG4gIGNvbnNvbGUubG9nKGJhc2UpO1xuICBET00ucmVuZGVyUHJvamVjdFByZXZpZXcobmV3UHJvamVjdCk7XG59KTtcblxuYXNpZGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgY29uc3QgYWN0aXZlUHJvamVjdFNlbGVjdCA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KCcucHJvamVjdC1wcmV2aWV3Jyk7XG4gIGlmICghYWN0aXZlUHJvamVjdFNlbGVjdCkgcmV0dXJuO1xuICBpZiAoYWN0aXZlUHJvamVjdFNlbGVjdC50ZXh0Q29udGVudCA9PT0gYWN0aXZlUHJvamVjdC5uYW1lKSByZXR1cm47XG4gIGNvbnNvbGUubG9nKCdwcm9qZWN0IHNlbGVjdGVkJyk7XG4gIGNvbnNvbGUubG9nKGFjdGl2ZVByb2plY3RTZWxlY3QpO1xuICAvLyBjb25zb2xlLmxvZygnQkFTRUVFRUVFRUUnLCBiYXNlLnByb2plY3RzKTtcbiAgYWN0aXZlUHJvamVjdCA9IGJhc2UucHJvamVjdHMuZmluZChcbiAgICAocHJvamVjdCkgPT4gcHJvamVjdC5uYW1lID09PSBhY3RpdmVQcm9qZWN0U2VsZWN0LnRleHRDb250ZW50XG4gICk7XG4gIGJhc2UuYWN0aXZlUHJvamVjdCA9IGFjdGl2ZVByb2plY3Q7XG4gIC8vIGNvbnNvbGUubG9nKGJhc2UpO1xuICAvLyBhY3RpdmVQcm9qZWN0LnRvZG9zLnB1c2gobmV3IFRvRG8oMSwgMSwgMSwgJ2xvdycpKTtcbiAgY29uc29sZS5sb2coYWN0aXZlUHJvamVjdCk7XG4gIERPTS5yZW5kZXJBbGxUb0RvKGFjdGl2ZVByb2plY3QudG9kb3MpO1xuICAvLyBhY3RpdmVQcm9qZWN0LnRvZG9zLmZvckVhY2goKHRvZG8pID0+IERPTS5yZW5kZXJUb0RvKHRvZG8pKTtcbiAgY29uc29sZS5sb2coYWN0aXZlUHJvamVjdC50b2Rvcyk7XG4gIGNvbnNvbGUubG9nKGJhc2UpO1xufSk7XG5cbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgY29uc3QgdG9kb1Nob3dCdG4gPSBldmVudC50YXJnZXQuY2xvc2VzdCgnLnNob3ctZnVsbCcpO1xuICBpZiAoIXRvZG9TaG93QnRuKSByZXR1cm47XG4gIGNvbnNvbGUubG9nKHRvZG9TaG93QnRuKTtcbiAgdG9kb1Nob3dCdG4udGV4dENvbnRlbnQgPSB0b2RvU2hvd0J0bi50ZXh0Q29udGVudCA9PT0gJysnID8gJy0nIDogJysnO1xuICBET00udG9kb1Nob3codG9kb1Nob3dCdG4uY2xvc2VzdCgnLnRvZG8nKS5uZXh0U2libGluZyk7XG59KTtcblxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcigndWwnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uIChldmVudCkge1xuICBjb25zdCBidG5NYXJrQXNGaW5pc2hlZCA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KCcuZmluaXNoJyk7XG4gIGlmICghYnRuTWFya0FzRmluaXNoZWQpIHJldHVybjtcbiAgY29uc3QgdG9kbyA9IGJ0bk1hcmtBc0ZpbmlzaGVkLmNsb3Nlc3QoJ2xpJyk7XG4gIGNvbnNvbGUubG9nKHRvZG8uZGF0YXNldC5pZCk7XG4gIGNvbnNvbGUubG9nKGFjdGl2ZVByb2plY3QuZmluZFRvRG9CeUlEKCt0b2RvLmRhdGFzZXQuaWQpKTtcbiAgYWN0aXZlUHJvamVjdC5maW5kVG9Eb0J5SUQoK3RvZG8uZGF0YXNldC5pZCkubWFya0FzRmluaXNoZWQoKTtcbiAgRE9NLnRvZ2dsZUZpbmlzaGVkTWFyayh0b2RvKTtcbiAgaGVscGVyLnNhdmVEYXRhKGJhc2UpO1xufSk7XG5cbi8vIGNvbnN0IGpzb25zb3MgPSBKU09OLnN0cmluZ2lmeShiYXNlKTtcbi8vIGNvbnN0IHVuanNvbnNvcyA9IEpTT04ucGFyc2UoanNvbnNvcyk7XG4vLyBjb25zb2xlLmxvZyhKU09OLnBhcnNlKGpzb25zb3MpKTtcbi8vIGNvbnNvbGUubG9nKGpzb25zb3MpO1xuLy8gdW5qc29uc29zLnByb2plY3RzLmZvckVhY2goKHByb2plY3QpID0+IE9iamVjdC5hc3NpZ24ocHJvamVjdCwgbmV3IFByb2plY3QoKSkpO1xuLy8gY29uc29sZS5sb2codW5qc29uc29zKTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuLy8gY29uc3QgdGVzdCA9IGJhc2UucHJvamVjdHNbMF0udG9kb3M7XG4vLyBjb25zb2xlLmxvZyh0ZXN0KTtcbi8vIGNvbnN0IHRleHRKU09OID0gSlNPTi5zdHJpbmdpZnkodGVzdCk7XG4vLyBjb25zdCBoYWxmSlNPTiA9IEpTT04ucGFyc2UodGV4dEpTT04pO1xuLy8gY29uc29sZS5sb2coaGFsZkpTT04pO1xuLy8gY29uc3Qgb2JqQXJyYXkgPSBoYWxmSlNPTi5tYXAoXG4vLyAgICh0b2RvKSA9PiBuZXcgVG9Ebyh0b2RvLnRpdGxlLCB0b2RvLmRlc2NyaXB0aW9uLCB0b2RvLmRhdGUsIHRvZG8ucHJpb3JpdHkpXG4vLyApO1xuLy8gLy8gY29uc29sZS5sb2cob2JqQXJyYXkpO1xuLy8gY29uc3QgY29tcGxldGVPYmpBcnJheSA9IG9iakFycmF5Lm1hcCgob2JqLCBpKSA9PlxuLy8gICBPYmplY3QuYXNzaWduKG9iaiwgaGFsZkpTT05baV0pXG4vLyApO1xuLy8gLy8gY29uc29sZS5sb2coY29tcGxldGVPYmpBcnJheSk7XG4vLyBjb25zb2xlLmxvZyhoZWxwZXIpO1xuLy8gY29uc29sZS5sb2coaGVscGVyLmdldFRvRG9zKCkpO1xuLy8gaGVscGVyLmdldFByb2plY3RzKCk7XG4vLyBoZWxwZXIuc2F2ZURhdGEoKTtcblxuY29uc29sZS5sb2cobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3d0ZicpKTtcbiIsImltcG9ydCBEYXRhIGZyb20gJy4vRGF0YSc7XG5pbXBvcnQgUHJvamVjdCBmcm9tICcuL1Byb2plY3QnO1xuaW1wb3J0IFRvRG8gZnJvbSAnLi9Ub0RvJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgT2JqZWN0SGVscGVyIHtcbiAgY29uc3RydWN0b3IoYmFzZSkge1xuICAgIHRoaXMuYmFzZSA9IGJhc2U7XG4gICAgdGhpcy5wcm9qZWN0cyA9IGJhc2UucHJvamVjdHM7XG4gICAgdGhpcy50b2RvcyA9IHRoaXMucHJvamVjdHMubWFwKChwcm9qZWN0KSA9PiBwcm9qZWN0LnRvZG9zKTtcbiAgICB0aGlzLmJhc2VSZXN1bHQ7XG4gIH1cblxuICBnZXRUb0Rvcyh0b2Rvc0pTT04pIHtcbiAgICB0aGlzLnRvZG9zID0gdGhpcy5wcm9qZWN0cy5tYXAoKHByb2plY3QpID0+IHByb2plY3QudG9kb3MpO1xuICAgIC8vIGNvbnNvbGUubG9nKHRoaXMudG9kb3MpO1xuICAgIC8vIGNvbnN0IEpTT05zdHJpbmcgPSBKU09OLnN0cmluZ2lmeSh0aGlzLnRvZG9zKTtcbiAgICBjb25zdCByZXN1bHQgPSBKU09OLnBhcnNlKHRvZG9zSlNPTik7XG4gICAgY29uc3QgcmVzdWx0MiA9IEpTT04ucGFyc2UodG9kb3NKU09OKTtcbiAgICAvLyBjb25zb2xlLmxvZyhyZXN1bHQpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXN1bHQubGVuZ3RoOyBpKyspIHtcbiAgICAgIHJlc3VsdFtpXSA9IHJlc3VsdFtpXS5tYXAoXG4gICAgICAgIChvYmopID0+IG5ldyBUb0RvKG9iai50aXRsZSwgb2JqLmRlc2NyaXB0aW9uLCBvYmouZGF0ZSwgb2JqLnByaW9yaXR5KVxuICAgICAgKTtcbiAgICB9XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXN1bHQubGVuZ3RoOyBpKyspIHtcbiAgICAgIHJlc3VsdFtpXSA9IHJlc3VsdFtpXS5tYXAoKG9iaiwgaW5kZXgpID0+XG4gICAgICAgIE9iamVjdC5hc3NpZ24ob2JqLCByZXN1bHQyW2ldW2luZGV4XSlcbiAgICAgICk7XG4gICAgfVxuICAgIC8vIGNvbnNvbGUubG9nKHJlc3VsdCk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIGdldFByb2plY3RzKHByb2plY3RzSlNPTikge1xuICAgIC8vIGNvbnN0IEpTT05wcm9qZWN0cyA9IEpTT04uc3RyaW5naWZ5KHRoaXMucHJvamVjdHMpO1xuICAgIGxldCByZXN1bHQgPSBKU09OLnBhcnNlKHByb2plY3RzSlNPTik7XG4gICAgLy8gY29uc29sZS5sb2codGhpcy5wcm9qZWN0cyk7XG4gICAgY29uc29sZS5sb2coJy0tLS0tLS0tLS0tLS0tMC0wLTAtMC0wLTAtMC0wJyk7XG4gICAgY29uc29sZS5sb2cocmVzdWx0KTtcbiAgICBjb25zdCByZXN1bHQyID0gcmVzdWx0Lm1hcCgocHJvamVjdCkgPT4gbmV3IFByb2plY3QocHJvamVjdC5uYW1lKSk7XG4gICAgY29uc3QgcmVzdWx0MyA9IHJlc3VsdDIubWFwKChvYmosIGkpID0+IE9iamVjdC5hc3NpZ24ob2JqLCByZXN1bHRbaV0pKTtcbiAgICAvLyBjb25zb2xlLmxvZyhyZXN1bHQpO1xuICAgIHJldHVybiByZXN1bHQzO1xuICB9XG5cbiAgZ2V0QmFzZShiYXNlSlNPTikge1xuICAgIC8vIGNvbnN0IEpTT05iYXNlID0gSlNPTi5zdHJpbmdpZnkodGhpcy5iYXNlKTtcbiAgICAvLyBjb25zb2xlLmxvZyhKU09OYmFzZSk7XG4gICAgY29uc3QgSlNPTnJlc3VsdCA9IEpTT04ucGFyc2UoYmFzZUpTT04pO1xuICAgIC8vIGNvbnNvbGUubG9nKEpTT05yZXN1bHQpO1xuICAgIGxldCByZXN1bHQgPSBuZXcgRGF0YSgpO1xuICAgIHJlc3VsdCA9IE9iamVjdC5hc3NpZ24ocmVzdWx0LCBKU09OcmVzdWx0KTtcbiAgICAvLyBjb25zb2xlLmxvZyhyZXN1bHQpO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBzYXZlRGF0YShiYXNlKSB7XG4gICAgY29uc3QgYmFzZUpTT04gPSBKU09OLnN0cmluZ2lmeShiYXNlKTtcbiAgICBjb25zdCBwcm9qZWN0c0pTT04gPSBKU09OLnN0cmluZ2lmeShiYXNlLnByb2plY3RzKTtcbiAgICBjb25zdCB0b2Rvc0pTT04gPSBKU09OLnN0cmluZ2lmeShcbiAgICAgIGJhc2UucHJvamVjdHMubWFwKChwcm9qZWN0KSA9PiBwcm9qZWN0LnRvZG9zKVxuICAgICk7XG5cbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYmFzZScsIGJhc2VKU09OKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvamVjdHMnLCBwcm9qZWN0c0pTT04pO1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd0b2RvcycsIHRvZG9zSlNPTik7XG5cbiAgICBjb25zb2xlLmxvZyhiYXNlSlNPTik7XG4gICAgY29uc29sZS5sb2cocHJvamVjdHNKU09OKTtcbiAgICBjb25zb2xlLmxvZyh0b2Rvc0pTT04pO1xuXG4gICAgY29uc3QgYmFzZVJlc3VsdCA9IHRoaXMuZ2V0QmFzZShiYXNlSlNPTik7XG4gICAgY29uc3QgcHJvamVjdHNSZXN1bHQgPSB0aGlzLmdldFByb2plY3RzKHByb2plY3RzSlNPTik7XG4gICAgY29uc3QgdG9kb3NSZXN1bHQgPSB0aGlzLmdldFRvRG9zKHRvZG9zSlNPTik7XG5cbiAgICBjb25zb2xlLmxvZyh0b2Rvc1Jlc3VsdCk7XG4gICAgY29uc29sZS5sb2cocHJvamVjdHNSZXN1bHQpO1xuICAgIGNvbnNvbGUubG9nKGJhc2VSZXN1bHQpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcm9qZWN0c1Jlc3VsdC5sZW5ndGg7IGkrKykge1xuICAgICAgcHJvamVjdHNSZXN1bHRbaV0udG9kb3MgPSB0b2Rvc1Jlc3VsdFtpXTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKTtcbiAgICBiYXNlUmVzdWx0LnByb2plY3RzID0gcHJvamVjdHNSZXN1bHQ7XG4gICAgLy9URVNUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFxuXG4gICAgYmFzZVJlc3VsdC5hY3RpdmVQcm9qZWN0ID0gYmFzZVJlc3VsdC5wcm9qZWN0c1swXTtcbiAgICBjb25zb2xlLmxvZyhiYXNlUmVzdWx0KTtcblxuICAgIHJldHVybiBiYXNlUmVzdWx0O1xuICB9XG5cbiAgbG9hZERhdGEoKSB7XG4gICAgY29uc3QgYmFzZVJlc3VsdCA9IHRoaXMuZ2V0QmFzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYmFzZScpKTtcbiAgICBjb25zdCBwcm9qZWN0c1Jlc3VsdCA9IHRoaXMuZ2V0UHJvamVjdHMobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Byb2plY3RzJykpO1xuICAgIGNvbnN0IHRvZG9zUmVzdWx0ID0gdGhpcy5nZXRUb0Rvcyhsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9kb3MnKSk7XG5cbiAgICBjb25zb2xlLmxvZyh0b2Rvc1Jlc3VsdCk7XG4gICAgY29uc29sZS5sb2cocHJvamVjdHNSZXN1bHQpO1xuICAgIGNvbnNvbGUubG9nKGJhc2VSZXN1bHQpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwcm9qZWN0c1Jlc3VsdC5sZW5ndGg7IGkrKykge1xuICAgICAgcHJvamVjdHNSZXN1bHRbaV0udG9kb3MgPSB0b2Rvc1Jlc3VsdFtpXTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKTtcbiAgICBiYXNlUmVzdWx0LnByb2plY3RzID0gcHJvamVjdHNSZXN1bHQ7XG4gICAgLy9URVNUVFRUVFRUVFRUVFRUVFRUVFRUVFRUVFxuXG4gICAgYmFzZVJlc3VsdC5hY3RpdmVQcm9qZWN0ID0gYmFzZVJlc3VsdC5wcm9qZWN0c1swXTtcbiAgICBjb25zb2xlLmxvZyhiYXNlUmVzdWx0KTtcbiAgICByZXR1cm4gYmFzZVJlc3VsdDtcbiAgfVxufVxuXG4vL9Ch0L3QsNGH0LDQu9CwINGB0L7Qt9C00LDQtdC8INC40L3RgdGC0LDQvdGBINC60LvQsNGB0YHQsCDRgdC+INGB0LLQvtC50YHRgtCy0LDQvNC4INC40LcgSlNPTiA9PlxuLy/QntGB0YLQsNC70YzQvdC+0LUg0LLQvtGB0YHRgtCw0L3QsNCy0LvQuNCy0LDQtdC8INGH0LXRgNC10LcgT2JqZWN0LmFzc2lnblxuIl0sIm5hbWVzIjpbIkRhdGEiLCJjb25zdHJ1Y3RvciIsInRoaXMiLCJwcm9qZWN0cyIsImFjdGl2ZVByb2plY3QiLCJjb25zb2xlIiwibG9nIiwiYWRkUHJvamVjdCIsInByb2plY3QiLCJwdXNoIiwicmVtb3ZlUHJvamVjdCIsIlByb2plY3QiLCJuYW1lIiwidG9kb3MiLCJpZCIsImFkZFRvRG8iLCJ0b2RvIiwicmVtb3ZlVG9EbyIsImZpbmRJbmRleCIsImVsZW1lbnQiLCJzcGxpY2UiLCJzZXRJZCIsImZpbmRUb0RvQnlJRCIsInRvZG9JZCIsIlRvRG8iLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwiZGF0ZSIsInByaW9yaXR5IiwiaXNGaW5pc2hlZCIsInBhcmVudElkIiwibWFya0FzRmluaXNoZWQiLCJzZXRQYXJlbnRJZCIsInJlbmRlclRvRG8iLCJ1bCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImxpIiwiY3JlYXRlRWxlbWVudCIsInRvZG9FbCIsInRvZG9GdWxsIiwiYnRuc0NvbnRhaW5lciIsImRlbGV0ZUJ0biIsImZpbmlzaGVkQnV0b24iLCJzaG93RnVsbEJ0biIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwiYXBwZW5kQ2hpbGQiLCJpbnNlcnRBZGphY2VudEhUTUwiLCJzZXRBdHRyaWJ1dGUiLCJyZW5kZXJGb3JtIiwiY29udGFpbmVyIiwiZm9ybUNvbnRhaW5lciIsImZvcm1FbCIsImluc2VydEFkamFjZW50RWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmUiLCJyZW5kZXJQcm9qZWN0UHJldmlldyIsInByb2plY3RFbCIsInByb2plY3RQcmV2aWV3IiwicmVuZGVyVG9Eb1ByZXZpZXciLCJ0b2RvUHJldmlld0VsIiwicmVuZGVyQWxsVG9EbyIsImNsZWFyVG9Eb0xpc3QiLCJmb3JFYWNoIiwiaW5uZXJIVE1MIiwidG9kb1Nob3ciLCJ0b2dnbGUiLCJyZW5kZXJBbGxQcm9qZWN0UHJldmlldyIsImJhc2UiLCJyZWRuZXJBbGxUb0RvUHJldmlldyIsImkiLCJsZW5ndGgiLCJjbGVhclRvRG9QcmV2aWV3IiwicXVlcnlTZWxlY3RvckFsbCIsInByZXZpZXciLCJ0b2dnbGVGaW5pc2hlZE1hcmsiLCJwcm9qZWN0MSIsInRvZG8xIiwiaGVscGVyIiwibWFwIiwiYmFzZVJlc3VsdCIsImdldFRvRG9zIiwidG9kb3NKU09OIiwicmVzdWx0IiwiSlNPTiIsInBhcnNlIiwicmVzdWx0MiIsIm9iaiIsImluZGV4IiwiT2JqZWN0IiwiYXNzaWduIiwiZ2V0UHJvamVjdHMiLCJwcm9qZWN0c0pTT04iLCJnZXRCYXNlIiwiYmFzZUpTT04iLCJKU09OcmVzdWx0Iiwic2F2ZURhdGEiLCJzdHJpbmdpZnkiLCJsb2NhbFN0b3JhZ2UiLCJzZXRJdGVtIiwicHJvamVjdHNSZXN1bHQiLCJ0b2Rvc1Jlc3VsdCIsImxvYWREYXRhIiwiZ2V0SXRlbSIsImJ0bk5ldyIsImZvcm1OZXdQcm9qZWN0IiwiYXNpZGUiLCJoYW5kbGVyU3VibWl0IiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsImZyb21FbnRyaWVzIiwiRm9ybURhdGEiLCJzbGljZSIsImJ0bkNsb3NlIiwidGFyZ2V0IiwiY2xvc2VzdCIsInNlbGVjdGVkVG9EbyIsImRhdGFzZXQiLCJwcm9qZWN0TmFtZSIsInZhbHVlIiwibmV3UHJvamVjdCIsImFjdGl2ZVByb2plY3RTZWxlY3QiLCJmaW5kIiwidG9kb1Nob3dCdG4iLCJuZXh0U2libGluZyIsImJ0bk1hcmtBc0ZpbmlzaGVkIl0sInNvdXJjZVJvb3QiOiIifQ==
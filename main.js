(()=>{"use strict";class e{constructor(){this.projects=[],this.activeProject}addProject(e){return this.projects.push(e),this.projects}removeProject(){console.log(this.projects);const e=this.projects.findIndex((e=>e.name===this.activeProject.name));this.projects.splice(e,1),console.log(this.projects)}}class t{constructor(e){this.name=e,this.todos=[],this.id}addToDo(e){this.todos.push(e)}removeToDo(e){const t=this.todos.findIndex((t=>t.id===e));this.todos.splice(t,1)}setId(e){this.id=e}findToDoByID(e){const t=this.todos.findIndex((t=>t.id===e));return this.todos[t]}}class o{constructor(e,t,o,i){this.title=e,this.description=t,this.date=o,this.priority=i,this.isFinished=!1,this.id,this.parentId}markAsFinished(){this.isFinished=!1===this.isFinished}setId(e){this.id=e}setParentId(e){this.parentId=e}}new class{constructor(){}};const i=()=>Math.floor(999999999999998*Math.random()+1),s=new class{constructor(){}renderToDo=e=>{const t=document.querySelector("ul"),o=document.createElement("li"),i=document.createElement("div"),s=document.createElement("div"),r=document.createElement("div"),n=document.createElement("div"),d=document.createElement("div"),c=document.createElement("div"),a=document.createElement("div");a.classList.add("title-element"),i.classList.add("todo"),a.textContent=e.title,e.isFinished&&a.classList.add("finished"),i.classList.add(`${e.priority}`),n.textContent="delete",n.classList.add("delete"),d.classList.add("finish"),d.textContent="mark",c.classList.add("show-full"),c.textContent="+",r.classList.add("btns-container"),r.appendChild(c),r.appendChild(d),r.appendChild(n),i.appendChild(a),i.appendChild(r),o.appendChild(i),s.classList.add("todo-full"),s.classList.add("hidden"),s.classList.add(e.isFinished?"finished":"nope"),s.insertAdjacentHTML("afterbegin",`\n    \n    <p>\n      Description: ${e.description}\n    </p>\n    <p>Date: ${e.date}</p>`),o.appendChild(s),o.setAttribute("data-id",`${e.id}`),t.appendChild(o)};renderForm(){if(document.querySelector(".new-form-container"))return;const e=document.querySelector(".container"),t=document.createElement("div");t.classList.add("new-form-container");const o=document.createElement("form");o.setAttribute("action","submit"),o.insertAdjacentHTML("afterbegin",'<div class="field">\n<label for="title">Title: </label>\n<input type="text" name="title" id="title" required/>\n</div>\n<div class="field">\n<label for="description">Description: </label>\n<input type="text" name="description" id="description" required/>\n</div>\n<div class="field">\n<label for="date">Date: </label>\n<input type="date" name="date" id="date" required/>\n</div>\n<div class="radio-btn">\n<label for="low-prio">Low</label>\n<input type="radio" name="priority" id="low-prio" value="low" />\n<label for="med-prio">Medium</label>\n<input type="radio" name="priority" id="med-prio" value="med" />\n<label for="high-prio">High</label>\n<input type="radio" name="priority" id="high-prio" value="high" checked/>\n</div>\n<button type="submit">Submit</button>\n<div class="close-form"><div class="x">X</div></div>\n'),t.appendChild(o),e.insertAdjacentElement("afterbegin",t),document.querySelector(".close-form").addEventListener("click",(function(){t.remove()}))}renderProjectPreview(e){const t=document.createElement("div");t.classList.add("project");const o=document.createElement("div");o.classList.add("project-preview"),o.textContent=`${e.name}`,t.setAttribute("data-id",`${e.id}`),t.appendChild(o),document.querySelector(".project-container").appendChild(t)}renderToDoPreview(e){const t=document.createElement("div");t.classList.add("todo-preview"),t.textContent=`${e.title}`,e.isFinished&&t.classList.add("finished-preview"),t.setAttribute("data-parent",`${e.parentId}`),document.querySelector(`.project[data-id='${e.parentId}']`).insertAdjacentElement("beforeend",t)}renderAllToDo(e){this.clearToDoList(),e.forEach((e=>this.renderToDo(e)))}clearToDoList(){document.querySelector(".todos-list ul").innerHTML=""}todoShow(e){e.classList.toggle("hidden")}renderAllProjectPreview(e){e.projects.forEach((e=>this.renderProjectPreview(e)))}rednerAllToDoPreview(e){for(let t=0;t<e.projects.length;t++)e.projects[t].todos.forEach((e=>this.renderToDoPreview(e)))}clearToDoPreview(){document.querySelectorAll(".todo-preview").forEach((e=>e.remove()))}toggleFinishedMark(e){e.querySelector(".title-element").classList.toggle("finished"),e.querySelector(".todo-full").classList.toggle("finished")}clearAllProjectPreview(){document.querySelectorAll(".project").forEach((e=>e.remove()))}},r=function(e){e.preventDefault();const{title:t,description:r,date:a,priority:l}=Object.fromEntries(new FormData(this)),p=new o(t,r,a,l);p.setId(i()),p.setParentId(c.id),c.addToDo(p),s.renderToDo(...c.todos.slice(-1)),d.saveData(n),s.renderToDoPreview(p)};console.log("START");let n=new e;const d=new class{constructor(e){this.base=e,this.projects=e.projects,this.todos=this.projects.map((e=>e.todos)),this.baseResult}getToDos(e){this.todos=this.projects.map((e=>e.todos));const t=JSON.parse(e),i=JSON.parse(e);for(let e=0;e<t.length;e++)t[e]=t[e].map((e=>new o(e.title,e.description,e.date,e.priority)));for(let e=0;e<t.length;e++)t[e]=t[e].map(((t,o)=>Object.assign(t,i[e][o])));return t}getProjects(e){let o=JSON.parse(e);return o.map((e=>new t(e.name))).map(((e,t)=>Object.assign(e,o[t])))}getBase(t){const o=JSON.parse(t);let i=new e;return i=Object.assign(i,o),i}saveData(e){const t=JSON.stringify(e),o=JSON.stringify(e.projects),i=JSON.stringify(e.projects.map((e=>e.todos)));localStorage.setItem("base",t),localStorage.setItem("projects",o),localStorage.setItem("todos",i);const s=this.getBase(t),r=this.getProjects(o),n=this.getToDos(i);for(let e=0;e<r.length;e++)r[e].todos=n[e];return s.projects=r,s.activeProject=s.projects[0],s}loadData(){const e=this.getBase(localStorage.getItem("base")),t=this.getProjects(localStorage.getItem("projects")),o=this.getToDos(localStorage.getItem("todos"));for(let e=0;e<t.length;e++)t[e].todos=o[e];return e.projects=t,e.activeProject=e.projects[0],e}}(n);(()=>{const e=new t("Project Default"),i=new o("Gogogo","odin","today","low");i.parentId=1,i.setId(1),e.addToDo(i),e.setId(1),n.addProject(e),n.activeProject=n.projects[0]})();let c=n.activeProject;n=localStorage.getItem("base")&&"[]"!==localStorage.getItem("projects")?d.loadData():n,c=n.activeProject,s.renderAllProjectPreview(n),s.rednerAllToDoPreview(n),s.renderAllToDo(c.todos);const a=document.querySelector(".new-todo-btn"),l=document.querySelector(".project-form"),p=document.querySelector("aside"),u=document.querySelector(".delete-project");a.addEventListener("click",(function(){s.renderForm(),document.querySelector("form").addEventListener("submit",r)})),document.querySelector("ul").addEventListener("click",(function(e){const t=e.target.closest(".delete");if(!t)return;const o=t.closest("li");c.removeToDo(+o.dataset.id),o.remove(),s.clearToDoPreview(),s.rednerAllToDoPreview(n),d.saveData(n)})),l.addEventListener("submit",(function(e){e.preventDefault();const o=this.querySelector("input").value,r=new t(o);r.setId(i()),n.addProject(r),this.querySelector("input").value="",a.classList.contains("hidden")&&a.classList.remove("hidden"),s.renderProjectPreview(r)})),p.addEventListener("click",(function(e){const t=e.target.closest(".project-preview");t&&t.textContent!==c.name&&(c=n.projects.find((e=>e.name===t.textContent)),n.activeProject=c,a.classList.contains("hidden")&&a.classList.remove("hidden"),s.renderAllToDo(c.todos))})),document.querySelector("ul").addEventListener("click",(function(e){const t=e.target.closest(".show-full");t&&(t.textContent="+"===t.textContent?"-":"+",s.todoShow(t.closest(".todo").nextSibling))})),document.querySelector("ul").addEventListener("click",(function(e){const t=e.target.closest(".finish");if(!t)return;const o=t.closest("li");c.findToDoByID(+o.dataset.id).markAsFinished(),s.toggleFinishedMark(o),s.clearToDoPreview(),s.rednerAllToDoPreview(n),d.saveData(n)})),u.addEventListener("click",(function(){n.removeProject(),s.clearAllProjectPreview(),s.renderAllProjectPreview(n),s.rednerAllToDoPreview(n),s.clearToDoList(),d.saveData(n),a.classList.add("hidden")})),p.addEventListener("click",(function(e){const t=e.target.closest(".todo-preview");t&&(c=n.projects.find((e=>e.id===+t.dataset.parent)),n.activeProject=c,a.classList.contains("hidden")&&a.classList.remove("hidden"),s.renderAllToDo(c.todos))}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBT3JFLFVBQVVZLE9BQU8sVUFDakUsZ0JBQWtCMUQsRUFBY1ksWSIsInNvdXJjZXMiOlsid2VicGFjazovL29kaW4tdG9kby8uL3NyYy9EYXRhLmpzIiwid2VicGFjazovL29kaW4tdG9kby8uL3NyYy9Qcm9qZWN0LmpzIiwid2VicGFjazovL29kaW4tdG9kby8uL3NyYy9Ub0RvLmpzIiwid2VicGFjazovL29kaW4tdG9kby8uL3NyYy9IYW5kbGVyLmpzIiwid2VicGFjazovL29kaW4tdG9kby8uL3NyYy9NYXJrZG93bi5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG8vLi9zcmMvRE9NLmpzIiwid2VicGFjazovL29kaW4tdG9kby8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly9vZGluLXRvZG8vLi9zcmMvTG9jYWxTdG9yYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIERhdGEge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnByb2plY3RzID0gW107XG4gICAgdGhpcy5hY3RpdmVQcm9qZWN0O1xuICB9XG5cbiAgYWRkUHJvamVjdChwcm9qZWN0KSB7XG4gICAgdGhpcy5wcm9qZWN0cy5wdXNoKHByb2plY3QpO1xuICAgIHJldHVybiB0aGlzLnByb2plY3RzO1xuICB9XG4gIHJlbW92ZVByb2plY3QoKSB7XG4gICAgY29uc29sZS5sb2codGhpcy5wcm9qZWN0cyk7XG5cbiAgICBjb25zdCBzZWxlY3RlZCA9IHRoaXMucHJvamVjdHMuZmluZEluZGV4KFxuICAgICAgKHByb2plY3QpID0+IHByb2plY3QubmFtZSA9PT0gdGhpcy5hY3RpdmVQcm9qZWN0Lm5hbWVcbiAgICApO1xuICAgIHRoaXMucHJvamVjdHMuc3BsaWNlKHNlbGVjdGVkLCAxKTtcbiAgICBjb25zb2xlLmxvZyh0aGlzLnByb2plY3RzKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUHJvamVjdCB7XG4gIGNvbnN0cnVjdG9yKG5hbWUpIHtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgIHRoaXMudG9kb3MgPSBbXTtcbiAgICB0aGlzLmlkO1xuICB9XG5cbiAgYWRkVG9Ebyh0b2RvKSB7XG4gICAgdGhpcy50b2Rvcy5wdXNoKHRvZG8pO1xuICB9XG4gIHJlbW92ZVRvRG8oaWQpIHtcbiAgICBjb25zdCB0b2RvID0gdGhpcy50b2Rvcy5maW5kSW5kZXgoKGVsZW1lbnQpID0+IGVsZW1lbnQuaWQgPT09IGlkKTtcbiAgICB0aGlzLnRvZG9zLnNwbGljZSh0b2RvLCAxKTtcbiAgfVxuICBzZXRJZChpZCkge1xuICAgIHRoaXMuaWQgPSBpZDtcbiAgfVxuICBmaW5kVG9Eb0J5SUQoaWQpIHtcbiAgICBjb25zdCB0b2RvSWQgPSB0aGlzLnRvZG9zLmZpbmRJbmRleCgoZWxlbWVudCkgPT4gZWxlbWVudC5pZCA9PT0gaWQpO1xuICAgIHJldHVybiB0aGlzLnRvZG9zW3RvZG9JZF07XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFRvRG8ge1xuICBjb25zdHJ1Y3Rvcih0aXRsZSwgZGVzY3JpcHRpb24sIGRhdGUsIHByaW9yaXR5KSB7XG4gICAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICB0aGlzLmRhdGUgPSBkYXRlO1xuICAgIHRoaXMucHJpb3JpdHkgPSBwcmlvcml0eTtcbiAgICB0aGlzLmlzRmluaXNoZWQgPSBmYWxzZTtcbiAgICB0aGlzLmlkO1xuICAgIHRoaXMucGFyZW50SWQ7XG4gIH1cblxuICBtYXJrQXNGaW5pc2hlZCgpIHtcbiAgICB0aGlzLmlzRmluaXNoZWQgPSB0aGlzLmlzRmluaXNoZWQgPT09IGZhbHNlID8gdHJ1ZSA6IGZhbHNlO1xuICB9XG5cbiAgc2V0SWQoaWQpIHtcbiAgICB0aGlzLmlkID0gaWQ7XG4gIH1cbiAgc2V0UGFyZW50SWQocGFyZW50SWQpIHtcbiAgICB0aGlzLnBhcmVudElkID0gcGFyZW50SWQ7XG4gIH1cbn1cbiIsImNsYXNzIEhhbmRsZXIge1xuICBjb25zdHJ1Y3RvcigpIHt9XG59XG5cbmV4cG9ydCBkZWZhdWx0IG5ldyBIYW5kbGVyKCk7XG4iLCJjb25zdCBmb3JtTWFya2Rvd24gPSBgPGRpdiBjbGFzcz1cImZpZWxkXCI+XG48bGFiZWwgZm9yPVwidGl0bGVcIj5UaXRsZTogPC9sYWJlbD5cbjxpbnB1dCB0eXBlPVwidGV4dFwiIG5hbWU9XCJ0aXRsZVwiIGlkPVwidGl0bGVcIiByZXF1aXJlZC8+XG48L2Rpdj5cbjxkaXYgY2xhc3M9XCJmaWVsZFwiPlxuPGxhYmVsIGZvcj1cImRlc2NyaXB0aW9uXCI+RGVzY3JpcHRpb246IDwvbGFiZWw+XG48aW5wdXQgdHlwZT1cInRleHRcIiBuYW1lPVwiZGVzY3JpcHRpb25cIiBpZD1cImRlc2NyaXB0aW9uXCIgcmVxdWlyZWQvPlxuPC9kaXY+XG48ZGl2IGNsYXNzPVwiZmllbGRcIj5cbjxsYWJlbCBmb3I9XCJkYXRlXCI+RGF0ZTogPC9sYWJlbD5cbjxpbnB1dCB0eXBlPVwiZGF0ZVwiIG5hbWU9XCJkYXRlXCIgaWQ9XCJkYXRlXCIgcmVxdWlyZWQvPlxuPC9kaXY+XG48ZGl2IGNsYXNzPVwicmFkaW8tYnRuXCI+XG48bGFiZWwgZm9yPVwibG93LXByaW9cIj5Mb3c8L2xhYmVsPlxuPGlucHV0IHR5cGU9XCJyYWRpb1wiIG5hbWU9XCJwcmlvcml0eVwiIGlkPVwibG93LXByaW9cIiB2YWx1ZT1cImxvd1wiIC8+XG48bGFiZWwgZm9yPVwibWVkLXByaW9cIj5NZWRpdW08L2xhYmVsPlxuPGlucHV0IHR5cGU9XCJyYWRpb1wiIG5hbWU9XCJwcmlvcml0eVwiIGlkPVwibWVkLXByaW9cIiB2YWx1ZT1cIm1lZFwiIC8+XG48bGFiZWwgZm9yPVwiaGlnaC1wcmlvXCI+SGlnaDwvbGFiZWw+XG48aW5wdXQgdHlwZT1cInJhZGlvXCIgbmFtZT1cInByaW9yaXR5XCIgaWQ9XCJoaWdoLXByaW9cIiB2YWx1ZT1cImhpZ2hcIiBjaGVja2VkLz5cbjwvZGl2PlxuPGJ1dHRvbiB0eXBlPVwic3VibWl0XCI+U3VibWl0PC9idXR0b24+XG48ZGl2IGNsYXNzPVwiY2xvc2UtZm9ybVwiPjxkaXYgY2xhc3M9XCJ4XCI+WDwvZGl2PjwvZGl2PlxuYDtcblxuY29uc3QgZ2VuZXJhdGVSYW5kb21OdW0gPSAoKSA9PiB7XG4gIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoOTk5OTk5OTk5OTk5OTk5IC0gMSkgKyAxKTtcbn07XG5cbmV4cG9ydCB7IGZvcm1NYXJrZG93biwgZ2VuZXJhdGVSYW5kb21OdW0gfTtcbiIsImltcG9ydCBIYW5kbGVyIGZyb20gJy4vSGFuZGxlcic7XG5pbXBvcnQgeyBmb3JtTWFya2Rvd24gfSBmcm9tICcuL01hcmtkb3duJztcblxuY2xhc3MgRE9NIHtcbiAgY29uc3RydWN0b3IoKSB7fVxuXG4gIHJlbmRlclRvRG8gPSAodG9kbykgPT4ge1xuICAgIGNvbnN0IHVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcigndWwnKTtcbiAgICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gICAgY29uc3QgdG9kb0VsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29uc3QgdG9kb0Z1bGwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBjb25zdCBidG5zQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29uc3QgZGVsZXRlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29uc3QgZmluaXNoZWRCdXRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNvbnN0IHNob3dGdWxsQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29uc3QgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0aXRsZS5jbGFzc0xpc3QuYWRkKCd0aXRsZS1lbGVtZW50Jyk7XG4gICAgdG9kb0VsLmNsYXNzTGlzdC5hZGQoJ3RvZG8nKTtcbiAgICB0aXRsZS50ZXh0Q29udGVudCA9IHRvZG8udGl0bGU7XG4gICAgaWYgKHRvZG8uaXNGaW5pc2hlZCkgdGl0bGUuY2xhc3NMaXN0LmFkZCgnZmluaXNoZWQnKTtcbiAgICB0b2RvRWwuY2xhc3NMaXN0LmFkZChgJHt0b2RvLnByaW9yaXR5fWApO1xuICAgIGRlbGV0ZUJ0bi50ZXh0Q29udGVudCA9ICdkZWxldGUnO1xuICAgIGRlbGV0ZUJ0bi5jbGFzc0xpc3QuYWRkKCdkZWxldGUnKTtcbiAgICBmaW5pc2hlZEJ1dG9uLmNsYXNzTGlzdC5hZGQoJ2ZpbmlzaCcpO1xuICAgIGZpbmlzaGVkQnV0b24udGV4dENvbnRlbnQgPSAnbWFyayc7XG4gICAgc2hvd0Z1bGxCdG4uY2xhc3NMaXN0LmFkZCgnc2hvdy1mdWxsJyk7XG4gICAgc2hvd0Z1bGxCdG4udGV4dENvbnRlbnQgPSAnKyc7XG4gICAgYnRuc0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdidG5zLWNvbnRhaW5lcicpO1xuICAgIGJ0bnNDb250YWluZXIuYXBwZW5kQ2hpbGQoc2hvd0Z1bGxCdG4pO1xuICAgIGJ0bnNDb250YWluZXIuYXBwZW5kQ2hpbGQoZmluaXNoZWRCdXRvbik7XG4gICAgYnRuc0NvbnRhaW5lci5hcHBlbmRDaGlsZChkZWxldGVCdG4pO1xuICAgIHRvZG9FbC5hcHBlbmRDaGlsZCh0aXRsZSk7XG4gICAgdG9kb0VsLmFwcGVuZENoaWxkKGJ0bnNDb250YWluZXIpO1xuICAgIGxpLmFwcGVuZENoaWxkKHRvZG9FbCk7XG5cbiAgICB0b2RvRnVsbC5jbGFzc0xpc3QuYWRkKCd0b2RvLWZ1bGwnKTtcbiAgICB0b2RvRnVsbC5jbGFzc0xpc3QuYWRkKGBoaWRkZW5gKTtcbiAgICB0b2RvRnVsbC5jbGFzc0xpc3QuYWRkKGAke3RvZG8uaXNGaW5pc2hlZCA/ICdmaW5pc2hlZCcgOiAnbm9wZSd9YCk7XG4gICAgdG9kb0Z1bGwuaW5zZXJ0QWRqYWNlbnRIVE1MKFxuICAgICAgJ2FmdGVyYmVnaW4nLFxuICAgICAgYFxuICAgIFxuICAgIDxwPlxuICAgICAgRGVzY3JpcHRpb246ICR7dG9kby5kZXNjcmlwdGlvbn1cbiAgICA8L3A+XG4gICAgPHA+RGF0ZTogJHt0b2RvLmRhdGV9PC9wPmBcbiAgICApO1xuICAgIGxpLmFwcGVuZENoaWxkKHRvZG9GdWxsKTtcbiAgICBsaS5zZXRBdHRyaWJ1dGUoJ2RhdGEtaWQnLCBgJHt0b2RvLmlkfWApO1xuICAgIHVsLmFwcGVuZENoaWxkKGxpKTtcbiAgfTtcblxuICByZW5kZXJGb3JtKCkge1xuICAgIGlmIChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubmV3LWZvcm0tY29udGFpbmVyJykpIHJldHVybjtcblxuICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250YWluZXInKTtcbiAgICBjb25zdCBmb3JtQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgZm9ybUNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCduZXctZm9ybS1jb250YWluZXInKTtcblxuICAgIGNvbnN0IGZvcm1FbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2Zvcm0nKTtcbiAgICBmb3JtRWwuc2V0QXR0cmlidXRlKCdhY3Rpb24nLCAnc3VibWl0Jyk7XG4gICAgZm9ybUVsLmluc2VydEFkamFjZW50SFRNTCgnYWZ0ZXJiZWdpbicsIGZvcm1NYXJrZG93bik7XG4gICAgZm9ybUNvbnRhaW5lci5hcHBlbmRDaGlsZChmb3JtRWwpO1xuICAgIGNvbnRhaW5lci5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyYmVnaW4nLCBmb3JtQ29udGFpbmVyKTtcblxuICAgIGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcignLmNsb3NlLWZvcm0nKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBmb3JtQ29udGFpbmVyLnJlbW92ZSgpO1xuICAgICAgfSk7XG4gIH1cblxuICByZW5kZXJQcm9qZWN0UHJldmlldyhwcm9qZWN0KSB7XG4gICAgY29uc3QgcHJvamVjdEVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgcHJvamVjdEVsLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QnKTtcbiAgICBjb25zdCBwcm9qZWN0UHJldmlldyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHByb2plY3RQcmV2aWV3LmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QtcHJldmlldycpO1xuXG4gICAgcHJvamVjdFByZXZpZXcudGV4dENvbnRlbnQgPSBgJHtwcm9qZWN0Lm5hbWV9YDtcbiAgICBwcm9qZWN0RWwuc2V0QXR0cmlidXRlKCdkYXRhLWlkJywgYCR7cHJvamVjdC5pZH1gKTtcblxuICAgIHByb2plY3RFbC5hcHBlbmRDaGlsZChwcm9qZWN0UHJldmlldyk7XG5cbiAgICBjb25zdCBwYXJlbnRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3QtY29udGFpbmVyJyk7XG4gICAgcGFyZW50RWxlbWVudC5hcHBlbmRDaGlsZChwcm9qZWN0RWwpO1xuICB9XG5cbiAgcmVuZGVyVG9Eb1ByZXZpZXcodG9kbykge1xuICAgIGNvbnN0IHRvZG9QcmV2aWV3RWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICB0b2RvUHJldmlld0VsLmNsYXNzTGlzdC5hZGQoJ3RvZG8tcHJldmlldycpO1xuICAgIHRvZG9QcmV2aWV3RWwudGV4dENvbnRlbnQgPSBgJHt0b2RvLnRpdGxlfWA7XG4gICAgaWYgKHRvZG8uaXNGaW5pc2hlZCkgdG9kb1ByZXZpZXdFbC5jbGFzc0xpc3QuYWRkKCdmaW5pc2hlZC1wcmV2aWV3Jyk7XG4gICAgdG9kb1ByZXZpZXdFbC5zZXRBdHRyaWJ1dGUoJ2RhdGEtcGFyZW50JywgYCR7dG9kby5wYXJlbnRJZH1gKTtcbiAgICBjb25zdCBwcm9qZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAucHJvamVjdFtkYXRhLWlkPScke3RvZG8ucGFyZW50SWR9J11gXG4gICAgKTtcblxuICAgIHByb2plY3QuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdiZWZvcmVlbmQnLCB0b2RvUHJldmlld0VsKTtcbiAgfVxuXG4gIHJlbmRlckFsbFRvRG8odG9kb3MpIHtcbiAgICB0aGlzLmNsZWFyVG9Eb0xpc3QoKTtcbiAgICB0b2Rvcy5mb3JFYWNoKCh0b2RvKSA9PiB0aGlzLnJlbmRlclRvRG8odG9kbykpO1xuICB9XG5cbiAgY2xlYXJUb0RvTGlzdCgpIHtcbiAgICBjb25zdCB0b0RvTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50b2Rvcy1saXN0IHVsJyk7XG4gICAgdG9Eb0xpc3QuaW5uZXJIVE1MID0gJyc7XG4gIH1cblxuICB0b2RvU2hvdyh0b2RvKSB7XG4gICAgdG9kby5jbGFzc0xpc3QudG9nZ2xlKCdoaWRkZW4nKTtcbiAgfVxuXG4gIHJlbmRlckFsbFByb2plY3RQcmV2aWV3KGJhc2UpIHtcbiAgICBiYXNlLnByb2plY3RzLmZvckVhY2goKHByb2plY3QpID0+IHRoaXMucmVuZGVyUHJvamVjdFByZXZpZXcocHJvamVjdCkpO1xuICB9XG5cbiAgcmVkbmVyQWxsVG9Eb1ByZXZpZXcoYmFzZSkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmFzZS5wcm9qZWN0cy5sZW5ndGg7IGkrKykge1xuICAgICAgYmFzZS5wcm9qZWN0c1tpXS50b2Rvcy5mb3JFYWNoKCh0b2RvKSA9PiB0aGlzLnJlbmRlclRvRG9QcmV2aWV3KHRvZG8pKTtcbiAgICB9XG4gIH1cblxuICBjbGVhclRvRG9QcmV2aWV3KCkge1xuICAgIGNvbnN0IHRvRG9QcmV2aWV3cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy50b2RvLXByZXZpZXcnKTtcbiAgICB0b0RvUHJldmlld3MuZm9yRWFjaCgocHJldmlldykgPT4gcHJldmlldy5yZW1vdmUoKSk7XG4gIH1cblxuICB0b2dnbGVGaW5pc2hlZE1hcmsodG9kbykge1xuICAgIHRvZG8ucXVlcnlTZWxlY3RvcignLnRpdGxlLWVsZW1lbnQnKS5jbGFzc0xpc3QudG9nZ2xlKCdmaW5pc2hlZCcpO1xuICAgIHRvZG8ucXVlcnlTZWxlY3RvcignLnRvZG8tZnVsbCcpLmNsYXNzTGlzdC50b2dnbGUoJ2ZpbmlzaGVkJyk7XG4gIH1cblxuICBjbGVhckFsbFByb2plY3RQcmV2aWV3KCkge1xuICAgIGNvbnN0IHByb2plY3RQcmV2aWV3cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wcm9qZWN0Jyk7XG4gICAgcHJvamVjdFByZXZpZXdzLmZvckVhY2goKHByZXZpZXcpID0+IHByZXZpZXcucmVtb3ZlKCkpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IG5ldyBET00oKTtcbiIsImltcG9ydCBEYXRhIGZyb20gJy4vRGF0YS5qcyc7XG5pbXBvcnQgUHJvamVjdCBmcm9tICcuL1Byb2plY3QuanMnO1xuaW1wb3J0IFRvRG8gZnJvbSAnLi9Ub0RvLmpzJztcbmltcG9ydCBET00gZnJvbSAnLi9ET00uanMnO1xuaW1wb3J0IE9iamVjdEhlbHBlciBmcm9tICcuL0xvY2FsU3RvcmFnZS5qcyc7XG5pbXBvcnQgeyBnZW5lcmF0ZVJhbmRvbU51bSB9IGZyb20gJy4vTWFya2Rvd24uanMnO1xuXG5jb25zdCBpbml0RGVmYXVsdFByb2plY3QgPSAoKSA9PiB7XG4gIGNvbnN0IHByb2plY3QxID0gbmV3IFByb2plY3QoJ1Byb2plY3QgRGVmYXVsdCcpO1xuICBjb25zdCB0b2RvMSA9IG5ldyBUb0RvKCdHb2dvZ28nLCAnb2RpbicsICd0b2RheScsICdsb3cnKTtcblxuICB0b2RvMS5wYXJlbnRJZCA9IDE7XG4gIHRvZG8xLnNldElkKDEpO1xuICBwcm9qZWN0MS5hZGRUb0RvKHRvZG8xKTtcbiAgcHJvamVjdDEuc2V0SWQoMSk7XG4gIGJhc2UuYWRkUHJvamVjdChwcm9qZWN0MSk7XG4gIGJhc2UuYWN0aXZlUHJvamVjdCA9IGJhc2UucHJvamVjdHNbMF07XG59O1xuY29uc3QgaW5pdFJlbmRlciA9ICgpID0+IHtcbiAgRE9NLnJlbmRlckFsbFByb2plY3RQcmV2aWV3KGJhc2UpO1xuICBET00ucmVkbmVyQWxsVG9Eb1ByZXZpZXcoYmFzZSk7XG4gIERPTS5yZW5kZXJBbGxUb0RvKGFjdGl2ZVByb2plY3QudG9kb3MpO1xufTtcbmNvbnN0IGhhbmRsZXJTdWJtaXQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3QgeyB0aXRsZSwgZGVzY3JpcHRpb24sIGRhdGUsIHByaW9yaXR5IH0gPSBPYmplY3QuZnJvbUVudHJpZXMoXG4gICAgbmV3IEZvcm1EYXRhKHRoaXMpXG4gICk7XG4gIGNvbnN0IHRvZG8gPSBuZXcgVG9Ebyh0aXRsZSwgZGVzY3JpcHRpb24sIGRhdGUsIHByaW9yaXR5KTtcbiAgdG9kby5zZXRJZChnZW5lcmF0ZVJhbmRvbU51bSgpKTtcbiAgdG9kby5zZXRQYXJlbnRJZChhY3RpdmVQcm9qZWN0LmlkKTtcbiAgYWN0aXZlUHJvamVjdC5hZGRUb0RvKHRvZG8pO1xuICBET00ucmVuZGVyVG9EbyguLi5hY3RpdmVQcm9qZWN0LnRvZG9zLnNsaWNlKC0xKSk7XG4gIGhlbHBlci5zYXZlRGF0YShiYXNlKTtcbiAgRE9NLnJlbmRlclRvRG9QcmV2aWV3KHRvZG8pO1xufTtcbmNvbnN0IGhhbmRsZXJEZWxldGUgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgY29uc3QgYnRuQ2xvc2UgPSBldmVudC50YXJnZXQuY2xvc2VzdCgnLmRlbGV0ZScpO1xuICBpZiAoIWJ0bkNsb3NlKSByZXR1cm47XG4gIGNvbnN0IHNlbGVjdGVkVG9EbyA9IGJ0bkNsb3NlLmNsb3Nlc3QoJ2xpJyk7XG4gIGFjdGl2ZVByb2plY3QucmVtb3ZlVG9Ebygrc2VsZWN0ZWRUb0RvLmRhdGFzZXQuaWQpO1xuICBzZWxlY3RlZFRvRG8ucmVtb3ZlKCk7XG4gIERPTS5jbGVhclRvRG9QcmV2aWV3KCk7XG4gIERPTS5yZWRuZXJBbGxUb0RvUHJldmlldyhiYXNlKTtcbiAgaGVscGVyLnNhdmVEYXRhKGJhc2UpO1xufTtcbmNvbnN0IGhhbmRsZXJOZXdQcm9qZWN0ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IHByb2plY3ROYW1lID0gdGhpcy5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpLnZhbHVlO1xuICBjb25zdCBuZXdQcm9qZWN0ID0gbmV3IFByb2plY3QocHJvamVjdE5hbWUpO1xuICBuZXdQcm9qZWN0LnNldElkKGdlbmVyYXRlUmFuZG9tTnVtKCkpO1xuICBiYXNlLmFkZFByb2plY3QobmV3UHJvamVjdCk7XG4gIHRoaXMucXVlcnlTZWxlY3RvcignaW5wdXQnKS52YWx1ZSA9ICcnO1xuICBpZiAoYnRuTmV3LmNsYXNzTGlzdC5jb250YWlucygnaGlkZGVuJykpIGJ0bk5ldy5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcblxuICBET00ucmVuZGVyUHJvamVjdFByZXZpZXcobmV3UHJvamVjdCk7XG59O1xuY29uc3QgaGFuZGxlckNoYW5nZUFjdGl2ZVBvcmplY3QgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgY29uc3QgYWN0aXZlUHJvamVjdFNlbGVjdCA9IGV2ZW50LnRhcmdldC5jbG9zZXN0KCcucHJvamVjdC1wcmV2aWV3Jyk7XG4gIGlmICghYWN0aXZlUHJvamVjdFNlbGVjdCkgcmV0dXJuO1xuICBpZiAoYWN0aXZlUHJvamVjdFNlbGVjdC50ZXh0Q29udGVudCA9PT0gYWN0aXZlUHJvamVjdC5uYW1lKSByZXR1cm47XG4gIGFjdGl2ZVByb2plY3QgPSBiYXNlLnByb2plY3RzLmZpbmQoXG4gICAgKHByb2plY3QpID0+IHByb2plY3QubmFtZSA9PT0gYWN0aXZlUHJvamVjdFNlbGVjdC50ZXh0Q29udGVudFxuICApO1xuICBiYXNlLmFjdGl2ZVByb2plY3QgPSBhY3RpdmVQcm9qZWN0O1xuICBpZiAoYnRuTmV3LmNsYXNzTGlzdC5jb250YWlucygnaGlkZGVuJykpIGJ0bk5ldy5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcblxuICBET00ucmVuZGVyQWxsVG9EbyhhY3RpdmVQcm9qZWN0LnRvZG9zKTtcbn07XG5jb25zdCBoYW5kbGVyU2hvd0Z1bGxJbmZvID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gIGNvbnN0IHRvZG9TaG93QnRuID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJy5zaG93LWZ1bGwnKTtcbiAgaWYgKCF0b2RvU2hvd0J0bikgcmV0dXJuO1xuICB0b2RvU2hvd0J0bi50ZXh0Q29udGVudCA9IHRvZG9TaG93QnRuLnRleHRDb250ZW50ID09PSAnKycgPyAnLScgOiAnKyc7XG4gIERPTS50b2RvU2hvdyh0b2RvU2hvd0J0bi5jbG9zZXN0KCcudG9kbycpLm5leHRTaWJsaW5nKTtcbn07XG5jb25zdCBoYW5kbGVyTWFya0FzRmluaXNoZWQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgY29uc3QgYnRuTWFya0FzRmluaXNoZWQgPSBldmVudC50YXJnZXQuY2xvc2VzdCgnLmZpbmlzaCcpO1xuICBpZiAoIWJ0bk1hcmtBc0ZpbmlzaGVkKSByZXR1cm47XG4gIGNvbnN0IHRvZG8gPSBidG5NYXJrQXNGaW5pc2hlZC5jbG9zZXN0KCdsaScpO1xuICBhY3RpdmVQcm9qZWN0LmZpbmRUb0RvQnlJRCgrdG9kby5kYXRhc2V0LmlkKS5tYXJrQXNGaW5pc2hlZCgpO1xuICBET00udG9nZ2xlRmluaXNoZWRNYXJrKHRvZG8pO1xuICBET00uY2xlYXJUb0RvUHJldmlldygpO1xuICBET00ucmVkbmVyQWxsVG9Eb1ByZXZpZXcoYmFzZSk7XG4gIGhlbHBlci5zYXZlRGF0YShiYXNlKTtcbn07XG5jb25zdCBoYW5kbGVyRGVsZXRlUHJvamVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgYmFzZS5yZW1vdmVQcm9qZWN0KCk7XG4gIERPTS5jbGVhckFsbFByb2plY3RQcmV2aWV3KCk7XG4gIERPTS5yZW5kZXJBbGxQcm9qZWN0UHJldmlldyhiYXNlKTtcbiAgRE9NLnJlZG5lckFsbFRvRG9QcmV2aWV3KGJhc2UpO1xuICBET00uY2xlYXJUb0RvTGlzdCgpO1xuICBoZWxwZXIuc2F2ZURhdGEoYmFzZSk7XG4gIGJ0bk5ldy5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbn07XG5jb25zdCBoYW5kbGVyVG9Eb1ByZXZpZXdDaGFnZUFjdGl2ZSA9IGZ1bmN0aW9uIChldmVudCkge1xuICBjb25zdCBjbGlja2VkID0gZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJy50b2RvLXByZXZpZXcnKTtcbiAgaWYgKCFjbGlja2VkKSByZXR1cm47XG4gIGFjdGl2ZVByb2plY3QgPSBiYXNlLnByb2plY3RzLmZpbmQoXG4gICAgKHByb2plY3QpID0+IHByb2plY3QuaWQgPT09ICtjbGlja2VkLmRhdGFzZXQucGFyZW50XG4gICk7XG4gIGJhc2UuYWN0aXZlUHJvamVjdCA9IGFjdGl2ZVByb2plY3Q7XG4gIGlmIChidG5OZXcuY2xhc3NMaXN0LmNvbnRhaW5zKCdoaWRkZW4nKSkgYnRuTmV3LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICBET00ucmVuZGVyQWxsVG9EbyhhY3RpdmVQcm9qZWN0LnRvZG9zKTtcbn07XG5cbmNvbnNvbGUubG9nKCdTVEFSVCcpO1xubGV0IGJhc2UgPSBuZXcgRGF0YSgpO1xuXG5jb25zdCBoZWxwZXIgPSBuZXcgT2JqZWN0SGVscGVyKGJhc2UpO1xuXG5pbml0RGVmYXVsdFByb2plY3QoKTtcblxubGV0IGFjdGl2ZVByb2plY3QgPSBiYXNlLmFjdGl2ZVByb2plY3Q7XG5iYXNlID1cbiAgbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2Jhc2UnKSAmJiBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncHJvamVjdHMnKSAhPT0gJ1tdJ1xuICAgID8gaGVscGVyLmxvYWREYXRhKClcbiAgICA6IGJhc2U7XG5cbmFjdGl2ZVByb2plY3QgPSBiYXNlLmFjdGl2ZVByb2plY3Q7XG5cbmluaXRSZW5kZXIoKTtcblxuY29uc3QgYnRuTmV3ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm5ldy10b2RvLWJ0bicpO1xuY29uc3QgZm9ybU5ld1Byb2plY3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdC1mb3JtJyk7XG5jb25zdCBhc2lkZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2FzaWRlJyk7XG5jb25zdCBkZWxldGVQcm9qZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmRlbGV0ZS1wcm9qZWN0Jyk7XG5cbi8vRVZFTlQgTElTVEVORVJTXG5cbmJ0bk5ldy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgRE9NLnJlbmRlckZvcm0oKTtcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignZm9ybScpLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGhhbmRsZXJTdWJtaXQpO1xufSk7XG5cbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVyRGVsZXRlKTtcblxuZm9ybU5ld1Byb2plY3QuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgaGFuZGxlck5ld1Byb2plY3QpO1xuXG5hc2lkZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZXJDaGFuZ2VBY3RpdmVQb3JqZWN0KTtcblxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcigndWwnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZXJTaG93RnVsbEluZm8pO1xuXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlck1hcmtBc0ZpbmlzaGVkKTtcblxuZGVsZXRlUHJvamVjdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGhhbmRsZXJEZWxldGVQcm9qZWN0KTtcblxuYXNpZGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVyVG9Eb1ByZXZpZXdDaGFnZUFjdGl2ZSk7XG4iLCJpbXBvcnQgRGF0YSBmcm9tICcuL0RhdGEnO1xuaW1wb3J0IFByb2plY3QgZnJvbSAnLi9Qcm9qZWN0JztcbmltcG9ydCBUb0RvIGZyb20gJy4vVG9Ebyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE9iamVjdEhlbHBlciB7XG4gIGNvbnN0cnVjdG9yKGJhc2UpIHtcbiAgICB0aGlzLmJhc2UgPSBiYXNlO1xuICAgIHRoaXMucHJvamVjdHMgPSBiYXNlLnByb2plY3RzO1xuICAgIHRoaXMudG9kb3MgPSB0aGlzLnByb2plY3RzLm1hcCgocHJvamVjdCkgPT4gcHJvamVjdC50b2Rvcyk7XG4gICAgdGhpcy5iYXNlUmVzdWx0O1xuICB9XG5cbiAgZ2V0VG9Eb3ModG9kb3NKU09OKSB7XG4gICAgdGhpcy50b2RvcyA9IHRoaXMucHJvamVjdHMubWFwKChwcm9qZWN0KSA9PiBwcm9qZWN0LnRvZG9zKTtcbiAgICBjb25zdCByZXN1bHQgPSBKU09OLnBhcnNlKHRvZG9zSlNPTik7XG4gICAgY29uc3QgcmVzdWx0MiA9IEpTT04ucGFyc2UodG9kb3NKU09OKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICByZXN1bHRbaV0gPSByZXN1bHRbaV0ubWFwKFxuICAgICAgICAob2JqKSA9PiBuZXcgVG9EbyhvYmoudGl0bGUsIG9iai5kZXNjcmlwdGlvbiwgb2JqLmRhdGUsIG9iai5wcmlvcml0eSlcbiAgICAgICk7XG4gICAgfVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICByZXN1bHRbaV0gPSByZXN1bHRbaV0ubWFwKChvYmosIGluZGV4KSA9PlxuICAgICAgICBPYmplY3QuYXNzaWduKG9iaiwgcmVzdWx0MltpXVtpbmRleF0pXG4gICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9XG5cbiAgZ2V0UHJvamVjdHMocHJvamVjdHNKU09OKSB7XG4gICAgbGV0IHJlc3VsdCA9IEpTT04ucGFyc2UocHJvamVjdHNKU09OKTtcbiAgICBjb25zdCByZXN1bHQyID0gcmVzdWx0Lm1hcCgocHJvamVjdCkgPT4gbmV3IFByb2plY3QocHJvamVjdC5uYW1lKSk7XG4gICAgY29uc3QgcmVzdWx0MyA9IHJlc3VsdDIubWFwKChvYmosIGkpID0+IE9iamVjdC5hc3NpZ24ob2JqLCByZXN1bHRbaV0pKTtcbiAgICByZXR1cm4gcmVzdWx0MztcbiAgfVxuXG4gIGdldEJhc2UoYmFzZUpTT04pIHtcbiAgICBjb25zdCBKU09OcmVzdWx0ID0gSlNPTi5wYXJzZShiYXNlSlNPTik7XG4gICAgbGV0IHJlc3VsdCA9IG5ldyBEYXRhKCk7XG4gICAgcmVzdWx0ID0gT2JqZWN0LmFzc2lnbihyZXN1bHQsIEpTT05yZXN1bHQpO1xuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBzYXZlRGF0YShiYXNlKSB7XG4gICAgLy8gaWYgKCFiYXNlLnByb2plY3RzKSByZXR1cm47XG4gICAgY29uc3QgYmFzZUpTT04gPSBKU09OLnN0cmluZ2lmeShiYXNlKTtcbiAgICBjb25zdCBwcm9qZWN0c0pTT04gPSBKU09OLnN0cmluZ2lmeShiYXNlLnByb2plY3RzKTtcbiAgICBjb25zdCB0b2Rvc0pTT04gPSBKU09OLnN0cmluZ2lmeShcbiAgICAgIGJhc2UucHJvamVjdHMubWFwKChwcm9qZWN0KSA9PiBwcm9qZWN0LnRvZG9zKVxuICAgICk7XG5cbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYmFzZScsIGJhc2VKU09OKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgncHJvamVjdHMnLCBwcm9qZWN0c0pTT04pO1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd0b2RvcycsIHRvZG9zSlNPTik7XG5cbiAgICBjb25zdCBiYXNlUmVzdWx0ID0gdGhpcy5nZXRCYXNlKGJhc2VKU09OKTtcbiAgICBjb25zdCBwcm9qZWN0c1Jlc3VsdCA9IHRoaXMuZ2V0UHJvamVjdHMocHJvamVjdHNKU09OKTtcbiAgICBjb25zdCB0b2Rvc1Jlc3VsdCA9IHRoaXMuZ2V0VG9Eb3ModG9kb3NKU09OKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcHJvamVjdHNSZXN1bHQubGVuZ3RoOyBpKyspIHtcbiAgICAgIHByb2plY3RzUmVzdWx0W2ldLnRvZG9zID0gdG9kb3NSZXN1bHRbaV07XG4gICAgfVxuXG4gICAgYmFzZVJlc3VsdC5wcm9qZWN0cyA9IHByb2plY3RzUmVzdWx0O1xuXG4gICAgYmFzZVJlc3VsdC5hY3RpdmVQcm9qZWN0ID0gYmFzZVJlc3VsdC5wcm9qZWN0c1swXTtcblxuICAgIHJldHVybiBiYXNlUmVzdWx0O1xuICB9XG5cbiAgbG9hZERhdGEoKSB7XG4gICAgY29uc3QgYmFzZVJlc3VsdCA9IHRoaXMuZ2V0QmFzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYmFzZScpKTtcbiAgICBjb25zdCBwcm9qZWN0c1Jlc3VsdCA9IHRoaXMuZ2V0UHJvamVjdHMobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Byb2plY3RzJykpO1xuICAgIGNvbnN0IHRvZG9zUmVzdWx0ID0gdGhpcy5nZXRUb0Rvcyhsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9kb3MnKSk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHByb2plY3RzUmVzdWx0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBwcm9qZWN0c1Jlc3VsdFtpXS50b2RvcyA9IHRvZG9zUmVzdWx0W2ldO1xuICAgIH1cblxuICAgIGJhc2VSZXN1bHQucHJvamVjdHMgPSBwcm9qZWN0c1Jlc3VsdDtcblxuICAgIGJhc2VSZXN1bHQuYWN0aXZlUHJvamVjdCA9IGJhc2VSZXN1bHQucHJvamVjdHNbMF07XG4gICAgcmV0dXJuIGJhc2VSZXN1bHQ7XG4gIH1cbn1cblxuLy/QodC90LDRh9Cw0LvQsCDRgdC+0LfQtNCw0LXQvCDQuNC90YHRgtCw0L3RgSDQutC70LDRgdGB0LAg0YHQviDRgdCy0L7QudGB0YLQstCw0LzQuCDQuNC3IEpTT04gPT5cbi8v0J7RgdGC0LDQu9GM0L3QvtC1INCy0L7RgdGB0YLQsNC90LDQstC70LjQstCw0LXQvCDRh9C10YDQtdC3IE9iamVjdC5hc3NpZ25cbiJdLCJuYW1lcyI6WyJEYXRhIiwiY29uc3RydWN0b3IiLCJ0aGlzIiwicHJvamVjdHMiLCJhY3RpdmVQcm9qZWN0IiwiYWRkUHJvamVjdCIsInByb2plY3QiLCJwdXNoIiwicmVtb3ZlUHJvamVjdCIsImNvbnNvbGUiLCJsb2ciLCJzZWxlY3RlZCIsImZpbmRJbmRleCIsIm5hbWUiLCJzcGxpY2UiLCJQcm9qZWN0IiwidG9kb3MiLCJpZCIsImFkZFRvRG8iLCJ0b2RvIiwicmVtb3ZlVG9EbyIsImVsZW1lbnQiLCJzZXRJZCIsImZpbmRUb0RvQnlJRCIsInRvZG9JZCIsIlRvRG8iLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwiZGF0ZSIsInByaW9yaXR5IiwiaXNGaW5pc2hlZCIsInBhcmVudElkIiwibWFya0FzRmluaXNoZWQiLCJzZXRQYXJlbnRJZCIsImdlbmVyYXRlUmFuZG9tTnVtIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwicmVuZGVyVG9EbyIsInVsIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwibGkiLCJjcmVhdGVFbGVtZW50IiwidG9kb0VsIiwidG9kb0Z1bGwiLCJidG5zQ29udGFpbmVyIiwiZGVsZXRlQnRuIiwiZmluaXNoZWRCdXRvbiIsInNob3dGdWxsQnRuIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJhcHBlbmRDaGlsZCIsImluc2VydEFkamFjZW50SFRNTCIsInNldEF0dHJpYnV0ZSIsInJlbmRlckZvcm0iLCJjb250YWluZXIiLCJmb3JtQ29udGFpbmVyIiwiZm9ybUVsIiwiaW5zZXJ0QWRqYWNlbnRFbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlbW92ZSIsInJlbmRlclByb2plY3RQcmV2aWV3IiwicHJvamVjdEVsIiwicHJvamVjdFByZXZpZXciLCJyZW5kZXJUb0RvUHJldmlldyIsInRvZG9QcmV2aWV3RWwiLCJyZW5kZXJBbGxUb0RvIiwiY2xlYXJUb0RvTGlzdCIsImZvckVhY2giLCJpbm5lckhUTUwiLCJ0b2RvU2hvdyIsInRvZ2dsZSIsInJlbmRlckFsbFByb2plY3RQcmV2aWV3IiwiYmFzZSIsInJlZG5lckFsbFRvRG9QcmV2aWV3IiwiaSIsImxlbmd0aCIsImNsZWFyVG9Eb1ByZXZpZXciLCJxdWVyeVNlbGVjdG9yQWxsIiwicHJldmlldyIsInRvZ2dsZUZpbmlzaGVkTWFyayIsImNsZWFyQWxsUHJvamVjdFByZXZpZXciLCJoYW5kbGVyU3VibWl0IiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsIk9iamVjdCIsImZyb21FbnRyaWVzIiwiRm9ybURhdGEiLCJzbGljZSIsImhlbHBlciIsInNhdmVEYXRhIiwibWFwIiwiYmFzZVJlc3VsdCIsImdldFRvRG9zIiwidG9kb3NKU09OIiwicmVzdWx0IiwiSlNPTiIsInBhcnNlIiwicmVzdWx0MiIsIm9iaiIsImluZGV4IiwiYXNzaWduIiwiZ2V0UHJvamVjdHMiLCJwcm9qZWN0c0pTT04iLCJnZXRCYXNlIiwiYmFzZUpTT04iLCJKU09OcmVzdWx0Iiwic3RyaW5naWZ5IiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsInByb2plY3RzUmVzdWx0IiwidG9kb3NSZXN1bHQiLCJsb2FkRGF0YSIsImdldEl0ZW0iLCJwcm9qZWN0MSIsInRvZG8xIiwiaW5pdERlZmF1bHRQcm9qZWN0IiwiYnRuTmV3IiwiZm9ybU5ld1Byb2plY3QiLCJhc2lkZSIsImRlbGV0ZVByb2plY3QiLCJidG5DbG9zZSIsInRhcmdldCIsImNsb3Nlc3QiLCJzZWxlY3RlZFRvRG8iLCJkYXRhc2V0IiwicHJvamVjdE5hbWUiLCJ2YWx1ZSIsIm5ld1Byb2plY3QiLCJjb250YWlucyIsImFjdGl2ZVByb2plY3RTZWxlY3QiLCJmaW5kIiwidG9kb1Nob3dCdG4iLCJuZXh0U2libGluZyIsImJ0bk1hcmtBc0ZpbmlzaGVkIiwiY2xpY2tlZCIsInBhcmVudCJdLCJzb3VyY2VSb290IjoiIn0=